(this["webpackJsonptreller-react"]=this["webpackJsonptreller-react"]||[]).push([[5],{186:function(e,t,a){"use strict";a.r(t);var n=a(17),c=a(41),r=a.n(c),l=a(42),o=a(40),s=a(0),i=a.n(s),u=a(21),d=a(58),m=(Object(d.a)((function(e){return e.board.currBoard}),(function(e){return e})),a(50)),b=a(3),f=a(68),p=a(56),v=a(51),k=a(53),g=a(22),E=a(2),h=a(65),O=a(9),j=a(94),N=function(e){var t=e.labels,a=e.onLabelClicked,n=void 0===a?null:a,c=e.expandMode,r=Object(u.c)(),l=Object(u.d)((function(e){return e.board.isExpanded})),o=function(e){e.preventDefault(),null!==n?n(e):r(Object(m.f)())};return i.a.createElement("div",{className:"labels-list"},t.map((function(e){return i.a.createElement("span",{onClick:o,key:e.id,className:"label  ".concat(l||c?"label-expand":""),style:{backgroundColor:e.color}},i.a.createElement("span",{className:"label-title"},e.title))})),c&&i.a.createElement("button",{className:"modal-btn",onClick:o},i.a.createElement(j.a,{className:"icon-md"})))},y=a(66),x=a.n(y),C=a(96),w=a(162),I=a(44);function S(){var e=Object(h.a)(["\n    ","\n            font-size:",";\n            font-family:",";\n\n            ","\n    "]);return S=function(){return e},e}var D=C.a.div(S(),(function(e){return e.cover.isFull?"color"===e.cover.type?{backgroundColor:e.cover.isFull?e.cover.background:""}:{backgroundImage:"url("+e.cover.background+")",minHeight:235,backgroundSize:"cover"}:""}),(function(e){return e.cover.isFull?"16px":""}),(function(e){return e.cover.isFull?"LatoBold":""}),(function(e){return e.cover.isFull?{display:"flex",fontSize:"16px",fontFamily:"LatoBold"}:""})),T={lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",sameElse:"MMMM D"},L=function(e){var t=e.task,a=e.index,n=Object(b.h)().url,c=Object(s.useMemo)((function(){return t.checklists.reduce((function(e,t){t.listItems.length>0&&(e+=t.listItems.reduce((function(e,t){return t.isDone&&e++,e}),0));return e}),0)}),[t.checklists]),r=Object(s.useMemo)((function(){return t.checklists.reduce((function(e,t){return t.listItems.length>0&&(e+=t.listItems.length),e}),0)}),[t.checklists]),l=Object(s.useMemo)((function(){if(t.dueDate){console.log("is due");var e=new Date;return e.setHours(0,0,0,0),e.setDate(e.getDate()+1),e.getTime()===t.dueDate?"due-soon":t.dueDate<=Date.now()?"over-due":""}}),[t.dueDate]);return i.a.createElement(f.b,{draggableId:t.id,index:a,type:"task"},(function(e){return i.a.createElement("div",Object.assign({className:"task-preview"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),i.a.createElement(O.b,{to:"".concat(n,"/").concat(t.id),className:"task-link",activeClassName:"active",draggable:"false"},i.a.createElement(D,{cover:t.cover},t.cover.background&&!t.cover.isFull&&i.a.createElement("div",null,"color"===t.cover.type?i.a.createElement("div",{className:t.cover.background?"task-cover":"",style:{backgroundColor:t.cover.background}}):i.a.createElement("img",{src:t.cover.background,className:"task-img-cover ratio-square "})),i.a.createElement("div",{className:"task-preview-content \n                                    ".concat("img"===t.cover.type&&t.cover.isFull?"dark"===t.cover.theme?"content-wrapper dark":"content-wrapper light":"")},t.labels&&i.a.createElement(N,{labels:t.labels}),i.a.createElement("div",{className:"task-preview-title",dir:"auto"},t.title),i.a.createElement("div",{className:"badges"},t.dueDate&&i.a.createElement("div",{className:"badge "+l},i.a.createElement(I.e,{className:"icon-sm"}),i.a.createElement(x.a,{className:"badge-text",calendar:T,date:t.dueDate})),t.description&&i.a.createElement("div",{className:"badge"},i.a.createElement(w.a,{className:"icon-md"})),t.checklists.length>0&&r>0&&i.a.createElement("div",{className:"badge checklist-items-badge "+(c===r?"task-complete":"")},i.a.createElement(j.b,{className:"icon-sm"}),i.a.createElement("span",{className:"badge-text"},c,"/",r)))))))}))};var A=function(e){var t=Object(s.useState)(!1),a=Object(o.a)(t,2),n=a[0],c=a[1];function r(t){t.key===e&&c(!0)}var l=function(t){t.key===e&&c(!1)};return Object(s.useEffect)((function(){return window.addEventListener("keydown",r),window.addEventListener("keyup",l),function(){window.removeEventListener("keydown",r),window.removeEventListener("keyup",l)}}),[]),n};var R=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(s.useEffect)((function(){var n=function(n){e&&e.current&&!e.current.contains(n.target)&&(null===a||a.current&&!a.current.contains(n.target)?t(n):console.log("exceptionalRef",a))};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,a,t])},M=function(e){var t=e.type,a=e.text,n=e.name,c=e.onInputBlur,r=e.isWide,l=e.isFocused,u=e.onChange,d=e.onSubmit,m=e.onEscape,b=e.placeholder,f=void 0===b?null:b,p=Object(s.useState)(!1),v=Object(o.a)(p,2),k=v[0],g=v[1],E=Object(s.useState)(""),h=Object(o.a)(E,2),O=h[0],j=h[1],N=Object(s.useRef)(null),y=A("Enter"),x=A("Escape");Object(s.useEffect)((function(){k&&N.current.focus()}),[k]),Object(s.useEffect)((function(){l&&g(!0),!1===l&&g(!1)}),[l,k]),Object(s.useEffect)((function(){k&&j(a)}),[k]),Object(s.useEffect)((function(){k&&!r&&(y&&(c?c():d(),g(!1)),x&&(u({target:{name:n,value:O}}),g(!1),m&&m()))}),[y,x]);var C=i.a.createElement(t,{className:"module-text  ".concat(a?"":"placeholder"),dir:"auto",onClick:function(){g(!0)}},a||f),w=function(){c&&(console.log("blur"),g(!1),c())};return i.a.createElement("div",{className:"text-editor-wrapper"},k?r?i.a.createElement("textarea",{ref:N,className:"focusClass",autoFocus:!0,rows:"5",name:n,defaultValue:a,onChange:function(e){u(e)},onBlur:w,placeholder:f}):i.a.createElement("input",{dir:"auto",type:"text",ref:N,autoFocus:!0,className:"focusClass",name:n,defaultValue:a,onChange:function(e){var t=e.target.value;/^\s+$/.test(t)||""===t||u(e)},onBlur:w}):C)},B=function(e){var t=e.onCloseMenu,a=e.onRemoveList,n=e.onAddTask;return i.a.createElement("div",{className:"pop-up list-menu"},i.a.createElement("div",{className:"pop-up-header"},i.a.createElement("span",{className:"pop-up-title"},"Labels"),i.a.createElement("button",{className:"pop-up-close-btn clear-btn",onClick:function(){return t()}},i.a.createElement(I.d,null))),i.a.createElement("div",{onClick:n},"Add card"),i.a.createElement("div",null,"Change list color"),i.a.createElement("div",null,"Sort list by"),i.a.createElement("div",{onClick:a},"Delete list"))},U=a(45),z=function(e){var t=e.provided,a=e.innerRef,n=e.taskList,c=e.taskListIdx,u=e.onListUpdated,d=e.onRemoveList,m=Object(s.useState)(Object(E.a)({},n)),v=Object(o.a)(m,2),k=v[0],h=v[1],O=Object(s.useState)(null),j=Object(o.a)(O,2),N=j[0],y=j[1],x=Object(s.useState)(!1),C=Object(o.a)(x,2),w=C[0],S=C[1],D=Object(b.h)().url,T=Object(s.useState)(!1),A=Object(o.a)(T,2),z=A[0],J=A[1],F=Object(s.useRef)(null);Object(s.useEffect)((function(){h(Object(E.a)({},n))}),[n]);var P=function(){J(!1);var e=U.a.getEmptyTask();y(e),S(!0)},_=function(e){y(Object(E.a)(Object(E.a)({},N),{},Object(g.a)({},e.target.name,e.target.value)))},H=function(e,t){if(e)u(e,t);else{if(k.title===n.title)return;u(k)}S(!1),y(null)},q=function(){var e=Object(l.a)(r.a.mark((function e(){var t,a,n,c=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:null,!N||!N.title){e.next=11;break}return(a=JSON.parse(JSON.stringify(k))).tasks.push(N),n=U.a.newActivity("Added this card to ".concat(a.title),'Added  <a href="#'.concat(D,"/").concat(N.id,'">').concat(N.title,"</a> to ").concat(a.title),N.id),e.next=7,H(a,n);case 7:if("clickedOutside"!==t){e.next=9;break}return e.abrupt("return");case 9:y(null),P();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();R(F,(function(){w&&N&&N.title?q("clickedOutside"):G()}));var G=function(){y(null),S(!1)};return k&&i.a.createElement("div",Object.assign({className:"list-wrapper",ref:a},t.draggableProps),i.a.createElement("div",{className:"list"},i.a.createElement("div",Object.assign({className:"list-header"},t.dragHandleProps),k.title&&i.a.createElement(M,{name:"title",type:"h3",text:k.title,onChange:function(e){h(Object(E.a)(Object(E.a)({},k),{},Object(g.a)({},e.target.name,e.target.value)))},onInputBlur:H}),i.a.createElement("button",{className:"list-menu-btn clear-btn",onClick:function(){return J(!z)}},i.a.createElement(p.a,null)),z&&!w&&i.a.createElement(B,{onRemoveList:function(){d(n.id)},onAddTask:P,onCloseMenu:function(){return J(!1)}})),i.a.createElement("div",{className:"overs"},i.a.createElement(f.c,{type:"task",droppableId:"".concat(c)},(function(e){return i.a.createElement("div",{className:"list-content custom-scrollbar",ref:e.innerRef},n.tasks.map((function(e,t){return i.a.createElement(L,{key:e.id,task:e,index:t})})),w&&N&&i.a.createElement("div",{className:"add-task-wrapper ",ref:F},i.a.createElement(M,{name:"title",type:"p",text:N.title,onChange:_,isFocused:w,onSubmit:q,onEscape:G}),i.a.createElement("div",{className:"add-task-controls"},i.a.createElement("button",{onClick:q,className:"submit-btn"},"Add task"),i.a.createElement("button",{onClick:G,className:"clear-btn icon-lg"},i.a.createElement(I.d,null)))),e.placeholder)}))),i.a.createElement("div",{className:"list-footer"},!w&&!N&&i.a.createElement("a",{className:"clear-btn list-footer-btn",onClick:P},i.a.createElement("span",{className:"icon-lg add-icon"},i.a.createElement(I.a,null))," ",i.a.createElement("span",null,"Add new task")))))},J=a(100),F=a.n(J),P=a(170),_=function(e){var t=e.task,a=e.labels,c=e.onCloseModal,r=e.onTaskUpdated,l=e.labelsUpdated,u=e.bounds,d=e.exceptionRef,m=Object(s.useState)(null),b=Object(o.a)(m,2),f=b[0],p=b[1],v=Object(s.useState)(!1),k=Object(o.a)(v,2),h=k[0],O=k[1],j=Object(s.useRef)(null);R(j,(function(){c()}),d);var N=function(e){p(Object(E.a)(Object(E.a)({},f),{},Object(g.a)({},e.target.name,e.target.value)))},y=function(){var e=Object(n.a)(a),t=e.findIndex((function(e){return e.id===f.id}));e.splice(t,1,f),l(Object(n.a)(e),f),O(!1),p(null)};Object(s.useEffect)((function(){if(!h&&f){var e=JSON.parse(JSON.stringify(t)),a=e.labels.findIndex((function(e){return e.id===f.id}));-1!==a&&(e.labels.splice(a,1,f),r(e))}}),[h]);var x=function(e){if(f)return e.id===f.id};return i.a.createElement("div",{className:"pop-up labels",ref:j,style:u},i.a.createElement("div",{className:"pop-up-header"},i.a.createElement("span",{className:"pop-up-title"},"Labels"),i.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:c},i.a.createElement(I.d,null))),i.a.createElement("ul",null,a.map((function(e){return i.a.createElement("li",{className:"label-container",key:e.id},i.a.createElement("span",{className:"card-label",style:{backgroundColor:e.color},onClick:function(){return function(e){var a=JSON.parse(JSON.stringify(t));if(a.labels.find((function(t){return t.id===e.id}))){var n=a.labels.findIndex((function(t){return t.id===e.id}));a.labels.splice(n,1)}else a.labels.push(e);r(a)}(e)}},!x(e)&&i.a.createElement("span",{className:"label-title"},e.title),x(e)&&h&&i.a.createElement(M,{type:"p",name:"title",isFocused:h,text:e.title,onChange:N,onInputBlur:y}),i.a.createElement("span",{className:"label-selected"})),i.a.createElement("button",{className:"clear-btn",onClick:function(){return function(e){null!==f&&f.id===e.id?O(!1):(p(Object(E.a)({},e)),O(!0))}(e)}},i.a.createElement(P.a,null)))}))))},H=a(95),q=a.n(H),G=a(184),W=(a(171),function(e){var t=e.task,a=e.onTaskUpdated,n=e.onCloseModal,c=e.bounds,u=e.exceptionRef,d=Object(s.useState)(new Date),m=Object(o.a)(d,2),f=m[0],p=m[1],v=Object(b.h)().url,k=Object(s.useRef)(null);Object(s.useEffect)((function(){if(t.dueDate){var e=new Date(t.dueDate);p(e)}}),[]),R(k,(function(){n()}),u);var g=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=q()(new Date(e)).format("MMM Do");return t.dueDate?U.a.newActivity("Changed the due date of this card to  ".concat(n),'Changed <a href="#'.concat(v,'">').concat(t.title,"</a> to be due at ").concat(n),t.id):a?U.a.newActivity("Removed the due date from this card",'Removed <a href="'.concat(v,'">').concat(t.title,"</a> due date"),t.id):U.a.newActivity("Set this card to be due at ".concat(n),'Set <a href="'.concat(v,'">').concat(t.title,"</a> to be due at ").concat(n," "),t.id)},E=function(){var e=Object(l.a)(r.a.mark((function e(){var c,l,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=f.getTime())!==t.dueDate){e.next=3;break}return e.abrupt("return");case 3:return(l=JSON.parse(JSON.stringify(t))).dueDate=c,o=g(c),e.next=8,a(l,o);case 8:n();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i.a.createElement("div",{className:"pop-up",style:c,ref:k},i.a.createElement("div",{className:"pop-up-header"},i.a.createElement("span",{className:"pop-up-title"},"Date"),i.a.createElement("button",{onClick:n,className:"pop-up-close-btn clear-btn icon-lg"},i.a.createElement(I.d,null))),i.a.createElement(G.a,{onChange:function(e){p(e)},value:f}),i.a.createElement("button",{onClick:E,className:"submit-btn add-date-btn"},"Save"))});function V(e){return function(t){t({type:"TOGGLE_INITIAL_ADDITION",isInitial:e})}}var Y=function(e){var t=e.task,a=e.onTaskUpdated,n=e.onCloseModal,c=e.bounds,r=e.sidebarRef,l=Object(s.useState)({}),d=Object(o.a)(l,2),m=d[0],f=d[1],p=Object(s.useRef)(null),v=Object(b.h)().url,k=Object(u.c)();Object(s.useEffect)((function(){var e=U.a.getEmptyCheckList();f(Object(E.a)({},e))}),[]),R(p,(function(){n()}),r);var h=function(){var e=JSON.parse(JSON.stringify(t)),c=Object(E.a)({},m);e.checklists.push(c);var r=U.a.newActivity("Added ".concat(m.title,"  on this card"),"Added ".concat(m.title,' on <a href="#').concat(v,'">').concat(t.title,"</a>"),t.id);a(e,r),k(V(!0)),n()};return i.a.createElement("div",{className:"pop-up",style:c,ref:p},i.a.createElement("div",{className:"pop-up-header"},i.a.createElement("span",{className:"pop-up-title"},"Add checklist"),i.a.createElement("button",{className:"pop-up-close-btn clear-btn"})),i.a.createElement(M,{isFocused:!0,onChange:function(e){f(Object(E.a)(Object(E.a)({},m),{},Object(g.a)({},e.target.name,e.target.value)))},onSubmit:h,type:"p",name:"title"}),i.a.createElement("button",{onClick:h,className:"submit-btn add-date-btn"},"Save"))},K=a(173),X=a.n(K),Q={uploadImg:function(e){console.log("yes");var t="https://api.cloudinary.com/v1_1/".concat("dhz1jk4k6","/image/upload"),a=new FormData;return a.append("file",e.target.files[0]),a.append("upload_preset","jtim2mm3"),fetch(t,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.error(e)}))}};function Z(){var e=Object(h.a)(["\n","\n"]);return Z=function(){return e},e}function $(){var e=Object(h.a)(["\n","\n"]);return $=function(){return e},e}var ee=C.a.div($(),(function(e){return"color"===e.cover.type?{backgroundColor:e.cover.background}:{backgroundImage:"url("+e.cover.background+")",backgroundSize:"cover"}})),te=C.a.div(Z(),(function(e){return"color"===e.cover.type?{backgroundColor:e.cover.background}:{backgroundImage:"light"===e.cover.theme?"linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),url("+e.cover.background+")":"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),url("+e.cover.background+")",backgroundSize:"cover",backgroundPosition:"50%"}})),ae=function(e){var t=e.task,a=e.onCloseModal,n=e.onTaskUpdated,c=e.bounds,u=e.exceptionRef,d=Object(s.useState)(t.cover),m=Object(o.a)(d,2),b=m[0],f=m[1],p=Object(s.useState)(!1),k=Object(o.a)(p,2),g=k[0],h=k[1],O=Object(s.useRef)(null);R(O,(function(){a()}),u);var j=function(e){var a=Object(E.a)({},t);e.id?(f(Object(E.a)(Object(E.a)({},b),{},{background:e.url,type:"img"})),a.cover.type="img",a.cover.background=e.url):(f(Object(E.a)(Object(E.a)({},b),{},{background:e,type:"color"})),a.cover.type="color",a.cover.background=e),n(a)},N=function(e){if(t.cover.background){f(Object(E.a)(Object(E.a)({},b),{},{isFull:e}));var a=Object(E.a)({},t);a.cover.isFull=e,n(a)}},y=function(e){if(e!==b.theme){f(Object(E.a)(Object(E.a)({},b),{},{theme:e}));var a=Object(E.a)({},t);a.cover.theme=e,n(a)}},x=function(){var e=Object(l.a)(r.a.mark((function e(a){var c,l,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("yes mame"),h(!0),e.next=4,Q.uploadImg(a);case 4:c=e.sent,l=c.url,f(Object(E.a)(Object(E.a)({},b),{},{background:l,type:"img"})),o=Object(E.a)({},t),s={id:v.a.makeId(),url:l,isCover:!0},o.images.push(s),o.cover.background=l,o.cover.type="img",n(o),h(!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return i.a.createElement("div",{className:"pop-up cover-picker ".concat(c?"":"absolute"),ref:O,style:c},i.a.createElement("div",{className:"pop-up-header"},i.a.createElement("span",{className:"pop-up-title"},"Cover"),i.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:a},i.a.createElement(I.d,null))),i.a.createElement("span",{className:"pop-up-title"},"Size"),i.a.createElement("div",{className:"cover-size-picker"},i.a.createElement(te,{cover:b,className:"cover-size "+(t.cover.background?b.isFull?"selected":"":"disabled"),onClick:function(){return N(!0)}},i.a.createElement("div",{className:"line-wrapper ".concat("img"===t.cover.type&&"dark"===t.cover.theme?"dark":"")},i.a.createElement("div",{className:"line line1"}),i.a.createElement("div",{className:"line line2"}),i.a.createElement("div",{className:"line line3"}))),i.a.createElement("div",{className:"cover-size half "+(t.cover.background?b.isFull?"":"selected":"disabled"),onClick:function(){return N(!1)}},i.a.createElement(ee,{className:"half",cover:b}),i.a.createElement("div",{className:"line-wrapper"},i.a.createElement("div",{className:"line line1"}),i.a.createElement("div",{className:"line line2"}),i.a.createElement("div",{className:"line line3"})))),t.cover.background&&i.a.createElement("button",{className:"modal-btn",onClick:function(){f(Object(E.a)(Object(E.a)({},b),{},{background:null,type:null,isFull:null,theme:null}));var e=Object(E.a)({},t);e.cover=Object(E.a)(Object(E.a)({},e.cover),{},{background:null,type:null,isFull:null,theme:null}),n(e),a()}},"Remove Cover"),"img"===b.type&&b.isFull&&i.a.createElement("div",{className:"cover-txt-color"},i.a.createElement("span",{className:"pop-up-title"},"Text color"),i.a.createElement("div",{className:"flex justify-center"},i.a.createElement("div",{onClick:function(){return y("light")},className:"cover-txt light",style:{backgroundImage:"linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),url(".concat(b.background,")")}},i.a.createElement("h3",null,t.title)),i.a.createElement("div",{onClick:function(){return y("dark")},className:"cover-txt dark",style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),url(".concat(b.background,")")}},i.a.createElement("h3",null,t.title)))),i.a.createElement("span",{className:"pop-up-title"},"Colors"),i.a.createElement("div",{className:"cover-palette"},["#61bd4f","#f2d600","#ff9f1a","#c377e0","#eb5a46","#055a8c","#705cc1","#00c2e0","#ff78cb"].map((function(e,t){return i.a.createElement("span",{className:"cover-color "+(e===b.background?"selected":""),style:{backgroundColor:e},key:t,onClick:function(){return j(e)}})}))),t.images.length>0&&i.a.createElement("span",{className:"pop-up-title"},"Images"),t.images.length>0&&i.a.createElement("div",{className:"cover-img-wrapper"},t.images.map((function(e){return i.a.createElement("span",{className:"cover-img-preview "+(e.url+e.id===b.background+e.id?"selected":""),style:{backgroundImage:"url(".concat(e.url,")")},onClick:function(){return j(e)},key:e.id})}))),i.a.createElement("div",{className:"upload-img-container flex space-between align-center"},i.a.createElement("p",null,"Upload image:"),i.a.createElement("input",{onChange:x,id:"file",type:"file",title:"Upload Image"}),i.a.createElement("label",{className:"btn-3",htmlFor:"file"},g?i.a.createElement(X.a,{height:9,width:5,color:"#2c3e50",loading:g}):i.a.createElement("span",null,"Upload"))),i.a.createElement("hr",{className:"divider"}))},ne=function(e){var t=e.task,a=e.labels,n=e.onUpdateTask,c=e.onLabelsUpdated,r=e.onAddActivity,l=Object(s.useRef)(null),u=Object(s.useState)(null),d=Object(o.a)(u,2),m=d[0],b=d[1],f=Object(s.useState)(null),p=Object(o.a)(f,2),v=p[0],k=p[1],g=Object(s.useRef)(null),E=function(e,t){g.current=e.target.id;var a=e.target.getBoundingClientRect(),n=a.top,c=a.left,r=a.height;window.innerWidth-c-304<50&&window.innerWidth>770?k({top:n+r,left:c-100}):k({top:n+r,left:c-50}),t===m?(b(null),k(null),g.current=null):b(t)},h=Object(s.useCallback)((function(){if(g.current){var e=document.getElementById(g.current).getBoundingClientRect(),t=e.top,a=e.left,n=e.height,c=window.innerWidth-a-304;k(c<50?{top:t+n,right:0}:{top:t+n,left:a})}}),[]);Object(s.useEffect)((function(){m?window.addEventListener("resize",h):window.removeEventListener("resize",h)}),[m]);var O=function(){b(null),g.current=null};return i.a.createElement("div",{className:"modal-sidebar",ref:l},i.a.createElement("h3",null,"Add to card"),i.a.createElement("button",{id:"sidebar-labels",className:"modal-btn",onClick:function(e){return E(e,"isLabelActive")}},"Labels"),"isLabelActive"===m&&i.a.createElement(_,{bounds:v,task:t,labels:a,onCloseModal:O,onTaskUpdated:n,labelsUpdated:c,exceptionRef:l}),i.a.createElement("button",{className:"modal-btn"},"Members"),i.a.createElement("button",{id:"sidebar-checklist",className:"modal-btn",onClick:function(e){return E(e,"isChecklistActive")}},"Checklist"),"isChecklistActive"===m&&i.a.createElement(Y,{task:t,bounds:v,onTaskUpdated:n,onCloseModal:O,exceptionRef:l}),i.a.createElement("button",{id:"sidebar-date",className:"modal-btn",onClick:function(e){return E(e,"isDueDateActive")}},"Due date"),"isDueDateActive"===m&&i.a.createElement(W,{bounds:v,task:t,onTaskUpdated:n,onAddActivity:r,onCloseModal:O,exceptionRef:l}),!t.cover.background&&i.a.createElement("button",{id:"sidebar-cover",className:"modal-btn",onClick:function(e){return E(e,"isCoverActive")}},"Cover"),"isCoverActive"===m&&i.a.createElement(ae,{bounds:v,exceptionRef:l,task:t,onCloseModal:O,onTaskUpdated:n}))},ce=a(178);var re=Object(s.memo)((function(e){var t=e.task,a=e.item,n=e.onSubmit,c=e.onRemoveItem,r=Object(s.useState)(Object(E.a)({},a)),l=Object(o.a)(r,2),u=l[0],d=l[1],m=Object(s.useState)(!1),f=Object(o.a)(m,2),v=f[0],k=f[1],h=Object(s.useState)(!1),O=Object(o.a)(h,2),j=O[0],N=O[1],y=Object(s.useState)(""),x=Object(o.a)(y,2),C=x[0],w=x[1],S=Object(s.useRef)(null),D=Object(s.useRef)(!0),T=Object(b.h)().url;R(S,(function(){v&&(a.title!==u.title&&(w(u.title),d((function(e){return Object(E.a)(Object(E.a)({},e),{},{title:a.title})})),N(!0)),k(!1))})),Object(s.useEffect)((function(){if(D.current)D.current=!1;else{var e=U.a.newActivity("".concat(u.isDone?"Completed  ".concat(a.title," on this card"):"Marked ".concat(a.title," incomplete on this card")),"".concat(u.isDone?"Completed  ".concat(a.title,' on <a href="#').concat(T,'">').concat(t.title,"</a>"):"Marked ".concat(a.title,' incomplete on <a href="#').concat(T,'">').concat(t.title,"</a>")),t.id);B(e)}}),[u.isDone]);var L=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;d(Object(E.a)(Object(E.a)({},u),{},Object(g.a)({},n,a)))},A=function(){k(!1)},B=function(e){u.title?(k(!1),N(!1),n(Object(E.a)({},u),e)):k(!0)};return i.a.createElement("div",{className:"checklist-item"},i.a.createElement("div",{className:"checklist-item-editor  "+(a.isDone?"done":"")},u&&!v&&i.a.createElement("input",{type:"checkbox",name:"isDone",checked:u.isDone,onChange:L}),i.a.createElement("div",{className:"item-title",onClick:function(){return k(!0)},ref:S},i.a.createElement(M,{text:a.title,onChange:L,onSubmit:B,onEscape:A,isFocused:v,type:"p",name:"title"}),v&&i.a.createElement("div",{className:"add-item-controls"},i.a.createElement("button",{className:"submit-btn"},"Save"),i.a.createElement("button",{className:"clear-btn icon-lg",onClick:A},i.a.createElement(I.d,null)),i.a.createElement("div",{className:"spacer",onClick:A}))),!v&&i.a.createElement("button",{className:"remove-item-btn clear-btn",onClick:function(){c(u.id)}},i.a.createElement(p.b,null))),j&&!v&&i.a.createElement("p",{className:"checklist-user-msg"},i.a.createElement("span",null,"You have unsaved edits on this field."),i.a.createElement("button",{className:"clear-btn",onClick:function(){d((function(e){return Object(E.a)(Object(E.a)({},e),{},{title:C})})),k(!0)}},"View edits"),i.a.createElement("button",{className:"clear-btn",onClick:function(){N(!1)}},"Discard")))}),(function(e,t){return ce(e.item,t.item)})),le=a(179),oe=(a(180),function(e){var t=e.task,a=e.checklist,n=e.onUpdateTask,c=Object(s.useState)(null),d=Object(o.a)(c,2),m=d[0],f=d[1],p=Object(s.useState)(a.title),v=Object(o.a)(p,2),k=v[0],h=v[1],O=Object(s.useState)(null),j=Object(o.a)(O,2),N=j[0],y=j[1],x=Object(s.useState)(!1),C=Object(o.a)(x,2),w=C[0],S=C[1],D=Object(s.useRef)(null),T=Object(b.h)().url,L=Object(u.c)(),A=Object(u.d)((function(e){return e.general.isInitialAddition}));Object(s.useEffect)((function(){A&&B()}),[]),Object(s.useMemo)((function(){var e=a.listItems.reduce((function(e,t){return t.isDone&&e++,e}),0),t=Math.round(100*e/a.listItems.length);y(t)}),[a]);var B=function(){var e=U.a.getEmptyListItem();f(e),S(!0),A&&L(V(!1))},z=function(){S(!1),f(null)};R(D,(function(){w&&(S(!1),f(null))}));var J=function(e){var t=Object(E.a)({},a),n=t.listItems.findIndex((function(t){return t.id===e}));-1!==n&&t.listItems.splice(n,1),P(t)},F=function(){var e=Object(l.a)(r.a.mark((function e(t,n){var c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Object(E.a)({},a),!t){e.next=9;break}if(-1===(l=c.listItems.findIndex((function(e){return e.id===t.id})))){e.next=7;break}return c.listItems.splice(l,1,t),e.next=7,P(c,n);case 7:e.next=16;break;case 9:if(m.title){e.next=12;break}return z(),e.abrupt("return");case 12:return c.listItems.push(m),e.next=15,P(c);case 15:B();case 16:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),P=function(e,c){var r=JSON.parse(JSON.stringify(t));if(e){var l=r.checklists.findIndex((function(t){return t.id===e.id}));r.checklists.splice(l,1,e)}else r.checklists=r.checklists.filter((function(e){return e.id!==a.id})),c=U.a.newActivity("Removed ".concat(a.title,"  on this card"),"Removed ".concat(a.title,' on <a href="#').concat(T,'">').concat(t.title,"</a>"),t.id);n(r,c),S(!1),f(null)};return i.a.createElement("div",{className:"task-checklist"},i.a.createElement("div",{className:"section-title flex align-center"},i.a.createElement(M,{text:k,onChange:function(e){h(e.target.value)},onInputBlur:function(){var e=Object(E.a)({},a);e.title=k;var n=U.a.newActivity("Renamed ".concat(e.title," from (").concat(a.title,")"),"Renamed ".concat(e.title," from (").concat(a.title,') on <a href="#').concat(T,'">').concat(t.title,"</a>"),t.id);P(e,n)},type:"h3"}),i.a.createElement("button",{className:"modal-btn",onClick:function(){return P()}},"Delete")),a.listItems.length>0&&i.a.createElement(le.Progress,{percent:N}),a&&a.listItems.map((function(e){return i.a.createElement(re,{key:e.id,onSubmit:F,onRemoveItem:J,item:e,task:t})})),m&&w&&i.a.createElement("div",{className:"add-item",ref:D},i.a.createElement(M,{onChange:function(e){f(Object(E.a)(Object(E.a)({},m),{},Object(g.a)({},e.target.name,e.target.value)))},onSubmit:F,onEscape:z,isFocused:w,type:"p",name:"title"}),i.a.createElement("div",{className:"add-item-controls"},i.a.createElement("button",{className:"submit-btn",onClick:function(){return F()}},"Save"),i.a.createElement("button",{className:"clear-btn icon-lg",onClick:z},i.a.createElement(I.d,null)),i.a.createElement("div",{className:"spacer",onClick:z}))),!w&&i.a.createElement("button",{className:"modal-btn",onClick:B},"Add an item"))}),se=a(181),ie=a.n(se),ue={lastDay:"[Yesterday at] LT",sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",lastWeek:"[last] dddd [at] LT",nextWeek:"dddd [at] LT",sameElse:"MMMM D [at] LT"},de=function(e){var t=e.taskId,a=void 0===t?null:t,n=Object(d.a)((function(e){return e.activity.activities}),(function(e){return a?e.filter((function(e){return e.taskId===a})):e})),c=Object(u.d)(n),r=Object(s.useState)(!0),l=Object(o.a)(r,2),m=l[0],b=l[1],f=Object(s.useState)(!0),p=Object(o.a)(f,2),v=p[0],k=p[1],g=Object(s.useState)(c.slice(0,5)),E=Object(o.a)(g,2),h=E[0],O=E[1],j=Object(s.useState)(5),N=Object(o.a)(j,2),y=N[0],C=N[1];Object(s.useEffect)((function(){O(c.slice(0,5)),k(!0),C(5)}),[c.length]);return i.a.createElement("div",{className:"activity-log"},a&&i.a.createElement("button",{className:"modal-btn",onClick:function(){b((function(e){return!e}))}},m?"Hide details":"Show details"),m&&h.length>0&&h.map((function(e){return i.a.createElement("div",{className:"activity-content",key:e.id},a?i.a.createElement("p",{className:"activity-desc",dangerouslySetInnerHTML:{__html:ie.a.sanitize(e.cardTxt)}}):i.a.createElement("p",{className:"activity-desc",dangerouslySetInnerHTML:{__html:ie.a.sanitize(e.boardTxt)}}),i.a.createElement(x.a,{calendar:ue},e.date))})),m&&v&&c.length>5&&i.a.createElement("button",{className:"clear-btn show-more-btn",onClick:function(){console.log("firstinDEX:",y);var e=y+5,t=e<=c.length-1;console.log("activities: ",c," index: ",y," newIndex: ",e);var a=h.concat(c.slice(y,e));C(e),O(a),k(t)}}," Load More "))};function me(e){return function(){var t=Object(l.a)(r.a.mark((function t(a,n){var c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=n().activity.boardId,t.prev=1,t.next=4,U.a.addActivity(c,e);case 4:a({type:"ADD_ACTIVITY",activity:e}),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(1),t.t0;case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,a){return t.apply(this,arguments)}}()}var be={lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",sameElse:"MMMM D"},fe=function(){var e=Object(u.c)(),t=Object(u.d)((function(e){return e.board.currTask})),a=Object(u.d)((function(e){return e.board.currBoard})),n=Object(s.useState)(null),c=Object(o.a)(n,2),d=c[0],f=c[1],p=Object(s.useState)(null),v=Object(o.a)(p,2),k=v[0],h=v[1],O=Object(s.useRef)(null),j=Object(s.useRef)(null),y=Object(s.useRef)(null),C=Object(b.g)().taskId,w=Object(b.f)(),S=Object(b.h)().url;Object(s.useEffect)((function(){(function(){var t=Object(l.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(Object(m.c)(C));case 2:t.sent||w.push("/board/".concat(a._id));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(s.useEffect)((function(){return document.body.style.overflowX="hidden",function(){document.body.style.overflowX="unset"}}),[]),Object(s.useEffect)((function(){t&&h(Object(E.a)({},t))}),[t]);var D=function(){w.push("/board/".concat(a._id))};R(O,(function(){D()})),R(j,(function(){f(null)}));var T=function(e){h(Object(E.a)(Object(E.a)({},k),{},Object(g.a)({},e.target.name,e.target.value)))},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?A(Object(E.a)({},e),t):A(Object(E.a)({},k))},A=Object(s.useCallback)((function(t,n){e(Object(m.g)(t));var c=JSON.parse(JSON.stringify(a));c.taskLists.forEach((function(e){var a=e.tasks.findIndex((function(e){return e.id===t.id}));-1!==a&&e.tasks.splice(a,1,t)})),e(Object(m.d)(c)),n&&e(me(n))}),[e]),B=function(t,n){var c=JSON.parse(JSON.stringify(a));c.labels=t,c.taskLists.forEach((function(e){e.tasks.forEach((function(e){var t=e.labels.find((function(e){return e.id===n.id}));t&&(t.title=n.title)}))})),e(Object(m.d)(c))},z=function(e,t){var a=e.target;y.current=a,f(t!==d?t:null)},J=Object(s.useMemo)((function(){if(t){var e=new Date;return e.setHours(0,0,0,0),e.setDate(e.getDate()+1),t.isDone?{class:"task-complete",txt:"Complete"}:e.getTime()===t.dueDate?{class:"due-soon",txt:"Due soon"}:t.dueDate<=Date.now()?{class:"over-due",txt:"Over due"}:""}}),[t]);return i.a.createElement("div",{className:"task-details"},i.a.createElement("div",{className:"cover"}),t&&i.a.createElement("div",{className:"task-modal",ref:O},t.cover.background&&i.a.createElement(F.a,{src:t.cover.background,crossOrigin:"anonymous",format:"hex"},(function(e){var a=e.data;return i.a.createElement("div",{className:"modal-header ",style:{backgroundImage:"url(".concat(t.cover.background,")"),backgroundColor:a||t.cover.background}},t.cover.background&&i.a.createElement("button",{className:"modal-btn",onClick:function(e){return z(e,"coverPicker")}},"Cover"),"coverPicker"===d&&i.a.createElement(ae,{task:t,onTaskUpdated:L,onCloseModal:function(){return z("coverPicker")},wrapperRef:j,exceptionRef:y}))})),i.a.createElement("a",{onClick:D,className:"modal-close-btn icon-lg"},i.a.createElement(I.d,null)),i.a.createElement("div",{className:"modal-module"},i.a.createElement("div",{className:"task-title"},i.a.createElement(M,{type:"h3",name:"title",text:t.title,onChange:T,onInputBlur:L}))),i.a.createElement("div",{className:"task-content"},i.a.createElement("div",{className:"left-side"},i.a.createElement("div",{className:"modal-module"},i.a.createElement("div",{className:"task-labels-date"},t.labels.length>0&&i.a.createElement("div",{className:"task-labels"},i.a.createElement("h3",{className:"task-item-title"},"Labels"),i.a.createElement("div",{className:"task-labels-list"},i.a.createElement(N,{expandMode:!0,onLabelClicked:function(e){return z(e,"labelPicker")},labels:t.labels})),"labelPicker"===d&&i.a.createElement(_,{task:t,onTaskUpdated:L,labelsUpdated:B,onCloseModal:function(){return z("labelPicker")},labels:a.labels,exceptionRef:y})),t.dueDate&&i.a.createElement("div",{className:"task-due-date"},i.a.createElement("h3",{className:"task-item-title"},"Due date"),i.a.createElement("div",{className:"modal-btn",onClick:function(e){return z(e,"datePicker")}},i.a.createElement("label",null,i.a.createElement("input",{className:"css-checkbox",type:"checkbox",name:"isDone",checked:t.isDone,onChange:function(e){e.stopPropagation(),e.preventDefault();var t=e.target.checked,a=Object(E.a)({},k);a.isDone=t;var n=U.a.newActivity("Marked the due date ".concat(a.isDone?"complete":"incomplete"),"Marked the due date ".concat(a.isDone?"complete":"incomplete"," on <a href='#").concat(S,"'>").concat(a.title,"</a>"),a.id);A(a,n)}}),i.a.createElement("i",null)),i.a.createElement(x.a,{calendar:be,date:t.dueDate}),i.a.createElement("span",{className:"task-badge "+(J?J.class:"")},J.txt),i.a.createElement(I.b,{className:"icon-lg"})),"datePicker"===d&&i.a.createElement(W,{task:t,onTaskUpdated:L,exceptionRef:y,onCloseModal:function(){return z("datePicker")}})))),i.a.createElement("div",{className:"modal-module"},i.a.createElement("div",{className:"task-description"},i.a.createElement("h3",{className:"section-title"},"Description"),i.a.createElement(M,{type:"p",name:"description",text:t.description,onChange:T,onInputBlur:L,isWide:!0,placeholder:"Add a more detailed description\u2026"}))),t.checklists.length>0&&i.a.createElement("div",{className:"modal-module"},t.checklists.map((function(e){return i.a.createElement(oe,{checklist:e,key:e.id,task:t,onUpdateTask:L})}))),i.a.createElement("div",{className:"modal-module"},i.a.createElement("h3",{className:"section-title"},"Activity"),i.a.createElement(de,{taskId:t.id}))),i.a.createElement("div",{className:"right-side"},a&&i.a.createElement(ne,{task:t,labels:a.labels,onUpdateTask:L,onLabelsUpdated:B})))))},pe=function(e){var t=e.board,a=e.onBoardUpdated,n=Object(s.useState)(null),c=Object(o.a)(n,2),r=c[0],l=c[1],u=Object(s.useRef)(null),d=function(){if(r.title){var e=JSON.parse(JSON.stringify(t));e.taskLists.push(r),a(e),l(null)}};return R(u,(function(){l(null)})),i.a.createElement("div",{className:"list-wrapper "},r?i.a.createElement("div",{className:"list add-list",ref:u},i.a.createElement(M,{isFocused:!0,onChange:function(e){l(Object(E.a)(Object(E.a)({},r),{},Object(g.a)({},e.target.name,e.target.value)))},onSubmit:d,name:"title",type:"p"}),i.a.createElement("div",{className:"add-list-controls"},i.a.createElement("button",{className:"submit-btn",onClick:d},"Add List"),i.a.createElement("button",{onClick:function(){return l(null)},className:"clear-btn icon-lg"},i.a.createElement(I.d,null)))):i.a.createElement("button",{className:"modal-btn",onClick:function(){var e=U.a.getEmptyList();l(e)}},"Add another list "))},ve=a(183),ke=a(182),ge=a.n(ke),Ee=a(67);function he(){var e=Object(h.a)(["\n  position: fixed;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n"]);return he=function(){return e},e}var Oe=Object(Ee.css)(he()),je=function(e){var t=e.onGoBack,a=e.board,n=e.onBoardUpdated,c=Object(s.useState)(null),r=Object(o.a)(c,2),l=r[0],u=r[1],d=Object(s.useState)(!1),m=Object(o.a)(d,2),b=m[0],f=(m[1],function(e,t){if(e!==a.style.background){var c=JSON.parse(JSON.stringify(a));c.style={background:e,type:t},n(c)}});return i.a.createElement("div",{className:"board-menu-bg-picker"},console.log("rednered"),i.a.createElement("button",{className:"pop-up-back-btn clear-btn icon-lg",onClick:function(){l?u(null):t()}},i.a.createElement(I.c,null)),!l&&i.a.createElement("div",{className:"bg-picker-controls"},i.a.createElement("div",{className:"bg-picker-btn",onClick:function(){return u("photos")}},i.a.createElement("span",{className:"photos image"}),i.a.createElement("span",{className:"bg-btn-title"},"Photos")),i.a.createElement("div",{className:"bg-picker-btn",onClick:function(){return u("colors")}},i.a.createElement("span",{className:"colors image"}),i.a.createElement("span",{className:"bg-btn-title"},"Colors"))),i.a.createElement(ge.a,{css:Oe,size:15,color:"#2c3e50",loading:b}),"photos"===l&&i.a.createElement("div",{className:"bg-section-wrapper"},["https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389449/Taskflow%20backgrounds/cacjncpn6qp4qivznyaj.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389449/Taskflow%20backgrounds/jukyghlsvncbyovcqvce.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389422/Taskflow%20backgrounds/2.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389420/Taskflow%20backgrounds/itjhqv6u26jigvxmzwsi.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389420/Taskflow%20backgrounds/sltgv2lrkmcbivdxxmb3.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389410/Taskflow%20backgrounds/yeozivyoaywjmj4hciwp.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389409/Taskflow%20backgrounds/idhd2wg760g7xa8vsze2.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389400/Taskflow%20backgrounds/t9jpmstlb7oaijmbynmw.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389394/Taskflow%20backgrounds/ponbl1heu65x22wus4ui.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389391/Taskflow%20backgrounds/nnobztxqgr82swa61ne4.jpg"].map((function(e,t){return i.a.createElement("span",{style:{backgroundImage:"url(".concat(e,")")},className:"bg-item",key:t,onClick:function(){return f(e,"img")}})}))),"colors"===l&&i.a.createElement("div",{className:"bg-section-wrapper"},["#61bd4f","#f2d600","#ff9f1a","#c377e0","#eb5a46","#055a8c","#705cc1","#00c2e0","#ff78cb"].map((function(e,t){return i.a.createElement("span",{className:"bg-item",style:{backgroundColor:e},key:t,onClick:function(){return f(e,"color")}})}))))},Ne=function(e){var t=e.isMenuOpen,a=e.closeMenu,n=e.menuBtnRef,c=e.board,r=e.onBoardUpdated,l=Object(b.f)(),u=Object(s.useRef)(null),d=Object(s.useState)(null),m=Object(o.a)(d,2),f=m[0],p=m[1];R(u,(function(){t&&a()}),n),Object(s.useEffect)((function(){t&&p(null)}),[t]),Object(s.useEffect)((function(){return l.listen((function(e){u.current.classList.contains("menu-open")&&a()}))}),[l]);var v=function(e){switch(e){case"backgroundPicker":p(Object(E.a)(Object(E.a)({},f),{},{type:e,title:"Background"}))}};return i.a.createElement("div",{className:"board-menu ".concat(t?"menu-open":"  "),ref:u},i.a.createElement("div",{className:"pop-up-header"},i.a.createElement("h3",null,f?f.title:"Menu"),i.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:a},i.a.createElement(I.d,null))),f?i.a.createElement("div",{className:"board-menu-content"},"backgroundPicker"===f.type&&i.a.createElement(je,{onGoBack:function(){p(null)},board:c,onBoardUpdated:r})):i.a.createElement("div",{className:"board-menu-content"},i.a.createElement("div",{className:"board-menu-nav"},i.a.createElement("button",{className:"clear-btn board-menu-nav-btn",onClick:function(){return v("backgroundPicker")}},"Change background"),i.a.createElement("button",{className:"clear-btn board-menu-nav-btn",onClick:function(){return v("boardName")}},"Change board name"),i.a.createElement("button",{className:"clear-btn board-menu-nav-btn"},"Delete board")),i.a.createElement("div",null,i.a.createElement("div",{className:"section-title"},i.a.createElement(ve.a,{className:"icon-sm"}),i.a.createElement("h4",{className:""},"Activity")),i.a.createElement(de,null))))};t.default=function(){var e=Object(b.g)().boardId,t=Object(b.h)().path,a=Object(b.f)(),c=Object(b.h)().url,d=Object(u.c)(),g=Object(u.d)((function(e){return e.board.currBoard})),E=Object(s.useRef)(!0),h=Object(s.useRef)(null),O=Object(s.useState)(!1),j=Object(o.a)(O,2),N=j[0],y=j[1];Object(s.useEffect)((function(){(function(){var t=Object(l.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d(Object(m.a)(e));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),a.push("/boards");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(s.useEffect)((function(){E.current&&g&&(d(function(e){return function(){var t=Object(l.a)(r.a.mark((function t(a){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,U.a.getActivities(e);case 3:n=t.sent,a({type:"SET_ACTIVITIES",activities:n}),a({type:"SET_BOARD_ID",boardId:e}),t.next=12;break;case 8:throw t.prev=8,t.t0=t.catch(0),console.warn("cannot load activities",t.t0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e)),k.a.setup(),k.a.emit("board topic",g._id),k.a.on("update board",w),E.current=!1)}),[g]),Object(s.useEffect)((function(){return function(){k.a.off("update board",w),k.a.terminate()}}),[]);var x=function(){var e=Object(l.a)(r.a.mark((function e(t){var a,n,c,l=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:null,n=JSON.parse(JSON.stringify(g)),c=n.taskLists.findIndex((function(e){return e.id===t.id})),n.taskLists.splice(c,1,t),e.next=6,C(n);case 6:a&&d(me(a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=Object(s.useCallback)((function(e){d(Object(m.d)(e))}),[d]),w=function(e){d(Object(m.e)(e))},I=function(e){var t=JSON.parse(JSON.stringify(g)),a=t.taskLists.findIndex((function(t){return t.id===e}));t.taskLists.splice(a,1),C(t)},S=function(){y((function(e){return!e}))};return g?i.a.createElement("section",{className:"board-details",style:"color"===g.style.type?{backgroundColor:"".concat(g.style.background)}:{backgroundImage:"url(".concat(g.style.background,")")}},i.a.createElement("div",{className:"board-header"},i.a.createElement("button",null,"CLICK HERE"),i.a.createElement("button",{className:"clear-btn open-menu-btn",onClick:S,ref:h},i.a.createElement("span",{className:"icon-sm"},i.a.createElement(p.a,null)),i.a.createElement("span",null,"Menu"))),i.a.createElement(Ne,{isMenuOpen:N,closeMenu:S,menuBtnRef:h,board:g,onBoardUpdated:C}),g&&i.a.createElement(f.a,{onDragEnd:function(e){var t=e.source,a=e.destination;if(a&&(t.index!==a.index||t.droppableId!==a.droppableId)){var r=Object(n.a)(g.taskLists),l=JSON.parse(JSON.stringify(g));if(t.droppableId===a.droppableId&&"board"===t.droppableId){var o=v.a.reorder(r,t.index,a.index);l.taskLists=o}else{var s=+t.droppableId,i=+a.droppableId;if(s===i){var u=v.a.reorder(r[s].tasks,t.index,a.index);l.taskLists[s].tasks=u}else{var m=v.a.move(r[s].tasks,r[i].tasks,t,a);l.taskLists[s].tasks=m[s],l.taskLists[i].tasks=m[i];var b={fromList:r[s].title,toList:r[i].title,task:r[s].tasks[t.index]},f=b.fromList,p=b.toList,k=b.task,E=U.a.newActivity("Moved this card from ".concat(f," to ").concat(p),'Moved  <a href="#'.concat(c,"/").concat(k.id,'">').concat(k.title,"</a> from ").concat(f," to ").concat(p),k.id)}}C(l),d(me(E))}}},i.a.createElement(f.c,{droppableId:"board",type:"lists",direction:"horizontal"},(function(e,t){return i.a.createElement("div",Object.assign({className:"list-container",ref:e.innerRef},e.droppableProps),g.taskLists&&g.taskLists.map((function(e,t){return i.a.createElement(f.b,{key:e.id,draggableId:e.id,index:t,type:"lists"},(function(a,n){return i.a.createElement(z,{taskListIdx:t,taskList:e,onRemoveList:I,onListUpdated:x,innerRef:a.innerRef,provided:a})}))})),e.placeholder,i.a.createElement(pe,{board:g,onBoardUpdated:C}))}))),g&&i.a.createElement(b.a,{exact:!0,path:"".concat(t,"/:taskId"),component:fe})):i.a.createElement("div",{style:{paddingTop:"50px"}},"baba")}},45:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(41),c=a.n(n),r=a(42),l=a(69),o=a.n(l).a.create({withCredentials:!0}),s=function(e,t){return u(e,"GET",t)},i=function(e,t){return u(e,"PUT",t)};function u(e){return d.apply(this,arguments)}function d(){return(d=Object(r.a)(c.a.mark((function e(t){var a,n,r,l=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:"get",n=l.length>2&&void 0!==l[2]?l[2]:null,e.prev=2,e.next=5,o({url:"".concat("/api/").concat(t),method:a,data:n});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:if(e.prev=9,e.t0=e.catch(2),401!==e.t0.response.status){e.next=14;break}throw console.log("ERROR: cannot find boards"),e.t0;case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var m=a(51),b={query:function(){return s("board")},getById:function(e){return f.apply(this,arguments)},update:function(e){return p.apply(this,arguments)},getEmptyList:function(){return{id:m.a.makeId(),title:"",theme:"white",tasks:[]}},getEmptyTask:function(){return{id:m.a.makeId(),title:"",description:"",creatorId:"",membersId:[],comments:[],dueDate:"",labels:[],isDone:!1,images:[],checklists:[],cover:{background:"",isFull:null,type:null}}},getEmptyCheckList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Checklist";return{id:m.a.makeId(),title:e,listItems:[]}},getEmptyListItem:function(){return{id:m.a.makeId(),title:"",isDone:!1}},newActivity:function(e,t,a){return{id:m.a.makeId(),cardTxt:e,boardTxt:t,taskId:a,date:Date.now()}},getActivities:function(e){return s("activity/".concat(e))},addActivity:function(e,t){return i("activity/".concat(e),t)}};function f(){return(f=Object(r.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s("board/".concat(t));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i("board/".concat(t._id),t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},50:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return m})),a.d(t,"g",(function(){return b})),a.d(t,"f",(function(){return f}));var n=a(41),c=a.n(n),r=a(42),l=a(45),o=a(53);function s(){return function(){var e=Object(r.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.query();case 2:(a=e.sent)&&t({type:"SET_BOARDS",boards:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}function i(e){return function(){var t=Object(r.a)(c.a.mark((function t(a){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.getById(e);case 3:n=t.sent,a({type:"SET_BOARD",currBoard:n}),t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(0),console.warn("cannot save board",t.t0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}function u(e){return function(){var t=Object(r.a)(c.a.mark((function t(a,n){var r,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n().board.currBoard,a({type:"SET_BOARD",currBoard:e}),t.prev=2,t.next=5,l.a.update(e);case 5:s=t.sent,console.log("after board saved",s),o.a.emit("update board",s),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),a({type:"SET_BOARD",currBoard:r}),console.log("Err: Board saving failed");case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,a){return t.apply(this,arguments)}}()}function d(e){return function(t){t({type:"SET_BOARD",currBoard:e})}}function m(e){return function(){var t=Object(r.a)(c.a.mark((function t(a,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a({type:"SET_TASK",id:e});case 2:return t.abrupt("return",n().board.currTask);case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}function b(e){return function(t){t({type:"UPDATE_TASK",currTask:e})}}function f(){return function(e){e({type:"TOGGLE_LABELS"})}}},51:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(40),c=a(17),r={makeId:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},applyDrag:function(e,t){var a=t.removedIndex,n=t.addedIndex,r=t.payload;if(null===a&&null===n)return console.log("apply drag null"),e;var l=Object(c.a)(e),o=r;null!==a&&(o=l.splice(a,1)[0]);null!==n&&l.splice(n,0,o);return l},reorder:function(e,t,a){var c=Array.from(e),r=c.splice(t,1),l=Object(n.a)(r,1)[0];return c.splice(a,0,l),c},move:function(e,t,a,c){var r=Array.from(e),l=Array.from(t),o=r.splice(a.index,1),s=Object(n.a)(o,1)[0];l.splice(c.index,0,s);var i={};return i[a.droppableId]=r,i[c.droppableId]=l,i}}},53:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n,c=a(78),r=a.n(c),l={setup:function(){n=r()("/")},terminate:function(){n=null},on:function(e,t){n.on(e,t)},off:function(e,t){n&&n.off(e,t)},emit:function(e,t){n&&n.emit(e,t)}}},88:function(e,t){}}]);
//# sourceMappingURL=5.9d5791bc.chunk.js.map