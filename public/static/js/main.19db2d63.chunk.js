(this["webpackJsonptreller-react"]=this["webpackJsonptreller-react"]||[]).push([[0],{105:function(e,t,a){e.exports=a(178)},161:function(e,t){},177:function(e,t,a){},178:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(27),l=a.n(r),o=a(9),s=a(11),i=a(10),u=function(){return console.log("process.env.NODE_ENV","production"),c.a.createElement("div",null,c.a.createElement("h1",{style:{paddingTop:"50px",fontSize:"100px"}},"Home Page"))},d=function(){return c.a.createElement("nav",{className:"main-navbar"},c.a.createElement(s.b,{to:"/",className:"main-navbar-nav-link",exact:!0,activeClassName:"active"},"Home "),"| ",c.a.createElement(s.b,{to:"/boards",className:"main-navbar-nav-link",exact:!0,activeClassName:"active"},"Boards "))},m=a(25),b=a(6),f=a.n(b),p=a(7),v=a(5),k=a(29),E=Object(k.a)((function(e){return e.board.currBoard}),(function(e){return e})),g=a(93),h=a.n(g).a.create({withCredentials:!0}),O=function(e,t){return N(e,"GET",t)},j=function(e,t){return N(e,"PUT",t)};function N(e){return y.apply(this,arguments)}function y(){return(y=Object(p.a)(f.a.mark((function e(t){var a,n,c,r=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:"get",n=r.length>2&&void 0!==r[2]?r[2]:null,e.prev=2,e.next=5,h({url:"".concat("/api/").concat(t),method:a,data:n});case 5:return c=e.sent,e.abrupt("return",c.data);case 9:if(e.prev=9,e.t0=e.catch(2),401!==e.t0.response.status){e.next=14;break}throw console.log("ERROR: cannot find boards"),e.t0;case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var x={makeId:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},applyDrag:function(e,t){var a=t.removedIndex,n=t.addedIndex,c=t.payload;if(null===a&&null===n)return console.log("apply drag null"),e;var r=Object(m.a)(e),l=c;null!==a&&(l=r.splice(a,1)[0]);null!==n&&r.splice(n,0,l);return r},reorder:function(e,t,a){var n=Array.from(e),c=n.splice(t,1),r=Object(v.a)(c,1)[0];return n.splice(a,0,r),n},move:function(e,t,a,n){var c=Array.from(e),r=Array.from(t),l=c.splice(a.index,1),o=Object(v.a)(l,1)[0];r.splice(n.index,0,o);var s={};return s[a.droppableId]=c,s[n.droppableId]=r,s}};var w={query:function(){return O("board")},getById:function(e){return C.apply(this,arguments)},update:function(e){return S.apply(this,arguments)},getEmptyList:function(){return{id:x.makeId(),title:"",theme:"white",tasks:[]}},getEmptyTask:function(){return{id:x.makeId(),title:"",description:"",creatorId:"",membersId:[],comments:[],dueDate:"",labels:[],isDone:!1,images:[],checklists:[],cover:{background:"",isFull:null,type:null}}},getEmptyCheckList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Checklist";return{id:x.makeId(),title:e,listItems:[]}},getEmptyListItem:function(){return{id:x.makeId(),title:"",isDone:!1}},newActivity:function(e,t,a){return{id:x.makeId(),cardTxt:e,boardTxt:t,taskId:a,date:Date.now()}}};function C(){return(C=Object(p.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("board/".concat(t));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(p.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j("board/".concat(t._id),t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I,D=a(94),T=a.n(D),L={setup:function(){I=T()("/")},terminate:function(){I=null},on:function(e,t){I.on(e,t)},off:function(e,t){I&&I.off(e,t)},emit:function(e,t){I&&I.emit(e,t)}};function A(e){return function(){var t=Object(p.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.getById(e);case 3:n=t.sent,a({type:"SET_BOARD",currBoard:n}),t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(0),console.warn("cannot save board",t.t0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}function R(e){return function(){var t=Object(p.a)(f.a.mark((function t(a){var n,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=JSON.parse(JSON.stringify(e))).activities=[],t.next=4,w.update(n);case 4:c=t.sent,console.log("afte boarrd saved",c),a({type:"SET_BOARD",currBoard:c}),L.emit("update board",c);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function M(e){return function(){var t=Object(p.a)(f.a.mark((function t(a,n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a({type:"SET_TASK",id:e});case 2:return t.abrupt("return",n().board.currTask);case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}function B(e){return function(t){t({type:"UPDATE_TASK",currTask:e})}}var J=a(21),U=a(23),z=a(13),_=a(3),F=a(24),P=a(41),G=function(e){var t=e.labels,a=e.onLabelClicked,n=void 0===a?null:a,r=e.expandMode,l=Object(o.c)(),s=Object(o.d)((function(e){return e.board.isExpanded})),i=function(e){e.preventDefault(),null!==n?n(e):l((function(e){e({type:"TOGGLE_LABELS"})}))};return c.a.createElement("div",{className:"labels-list"},t.map((function(e){return c.a.createElement("span",{onClick:i,key:e.id,className:"label  ".concat(s||r?"label-expand":""),style:{backgroundColor:e.color}},c.a.createElement("span",{className:"label-title"},e.title))})),r&&c.a.createElement("button",{className:"modal-btn",onClick:i},c.a.createElement(P.a,{className:"icon-md"})))},H=a(28),W=a.n(H),q=a(31),K=a(96),V=a(8);function Y(){var e=Object(F.a)(["\n    ","\n            font-size:",";\n            font-family:",";\n\n            ","\n    "]);return Y=function(){return e},e}var X=q.a.div(Y(),(function(e){return e.cover.isFull?"color"===e.cover.type?{backgroundColor:e.cover.isFull?e.cover.background:""}:{backgroundImage:"url("+e.cover.background+")",minHeight:235,backgroundSize:"cover"}:""}),(function(e){return e.cover.isFull?"16px":""}),(function(e){return e.cover.isFull?"LatoBold":""}),(function(e){return e.cover.isFull?{display:"flex",fontSize:"16px",fontFamily:"LatoBold"}:""})),$={lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",sameElse:"MMMM D"},Q=function(e){var t=e.task,a=e.index,r=Object(i.h)().url,l=Object(n.useMemo)((function(){return t.checklists.reduce((function(e,t){t.listItems.length>0&&(e+=t.listItems.reduce((function(e,t){return t.isDone&&e++,e}),0));return e}),0)}),[t.checklists]),o=Object(n.useMemo)((function(){return t.checklists.reduce((function(e,t){return t.listItems.length>0&&(e+=t.listItems.length),e}),0)}),[t.checklists]),u=Object(n.useMemo)((function(){if(t.dueDate){console.log("is due");var e=new Date;return e.setHours(0,0,0,0),e.setDate(e.getDate()+1),e.getTime()===t.dueDate?"due-soon":t.dueDate<=Date.now()?"over-due":""}}),[t.dueDate]);return c.a.createElement(J.b,{draggableId:t.id,index:a,type:"task"},(function(e){return c.a.createElement("div",Object.assign({className:"task-preview"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),c.a.createElement(s.b,{to:"".concat(r,"/").concat(t.id),className:"task-link",activeClassName:"active",draggable:"false"},c.a.createElement(X,{cover:t.cover},t.cover.background&&!t.cover.isFull&&c.a.createElement("div",null,"color"===t.cover.type?c.a.createElement("div",{className:t.cover.background?"task-cover":"",style:{backgroundColor:t.cover.background}}):c.a.createElement("img",{src:t.cover.background,className:"task-img-cover ratio-square "})),c.a.createElement("div",{className:"task-preview-content \n                                    ".concat("img"===t.cover.type&&t.cover.isFull?"dark"===t.cover.theme?"content-wrapper dark":"content-wrapper light":"")},t.labels&&c.a.createElement(G,{labels:t.labels}),c.a.createElement("div",{className:"task-preview-title",dir:"auto"},t.title),c.a.createElement("div",{className:"badges"},t.dueDate&&c.a.createElement("div",{className:"badge "+u},c.a.createElement(V.e,{className:"icon-sm"}),c.a.createElement(W.a,{className:"badge-text",calendar:$,date:t.dueDate})),t.description&&c.a.createElement("div",{className:"badge"},c.a.createElement(K.a,{className:"icon-md"})),t.checklists.length>0&&o>0&&c.a.createElement("div",{className:"badge checklist-items-badge "+(l===o?"task-complete":"")},c.a.createElement(P.b,{className:"icon-sm"}),c.a.createElement("span",{className:"badge-text"},l,"/",o)))))))}))};var Z=function(e){var t=Object(n.useState)(!1),a=Object(v.a)(t,2),c=a[0],r=a[1];function l(t){t.key===e&&r(!0)}var o=function(t){t.key===e&&r(!1)};return Object(n.useEffect)((function(){return window.addEventListener("keydown",l),window.addEventListener("keyup",o),function(){window.removeEventListener("keydown",l),window.removeEventListener("keyup",o)}}),[]),c};var ee=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(n.useEffect)((function(){var n=function(n){e&&e.current&&!e.current.contains(n.target)&&(null===a||a.current&&!a.current.contains(n.target)?t(n):console.log("exceptionalRef",a))};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,a,t])},te=function(e){var t=e.type,a=e.text,r=e.name,l=e.onInputBlur,o=e.isWide,s=e.isFocused,i=e.onChange,u=e.onSubmit,d=e.onEscape,m=e.placeholder,b=void 0===m?null:m,f=Object(n.useState)(!1),p=Object(v.a)(f,2),k=p[0],E=p[1],g=Object(n.useState)(""),h=Object(v.a)(g,2),O=h[0],j=h[1],N=Object(n.useRef)(null),y=Z("Enter"),x=Z("Escape");Object(n.useEffect)((function(){k&&N.current.focus()}),[k]),Object(n.useEffect)((function(){s&&E(!0),!1===s&&E(!1)}),[s,k]),Object(n.useEffect)((function(){k&&j(a)}),[k]),Object(n.useEffect)((function(){k&&!o&&(y&&(l?l():u(),E(!1)),x&&(i({target:{name:r,value:O}}),E(!1),d&&d()))}),[y,x]);var w=c.a.createElement(t,{className:"module-text  ".concat(a?"":"placeholder"),dir:"auto",onClick:function(){E(!0)}},a||b),C=function(){l&&(console.log("blur"),E(!1),l())};return c.a.createElement("div",{className:"text-editor-wrapper"},k?o?c.a.createElement("textarea",{ref:N,className:"focusClass",autoFocus:!0,rows:"5",name:r,defaultValue:a,onChange:function(e){i(e)},onBlur:C,placeholder:b}):c.a.createElement("input",{dir:"auto",type:"text",ref:N,autoFocus:!0,className:"focusClass",name:r,defaultValue:a,onChange:function(e){var t=e.target.value;/^\s+$/.test(t)||""===t||i(e)},onBlur:C}):w)},ae=function(e){var t=e.onCloseMenu,a=e.onRemoveList,n=e.onAddTask;return c.a.createElement("div",{className:"pop-up list-menu"},c.a.createElement("div",{className:"pop-up-header"},c.a.createElement("span",{className:"pop-up-title"},"Labels"),c.a.createElement("button",{className:"pop-up-close-btn clear-btn",onClick:function(){return t()}},c.a.createElement(V.d,null))),c.a.createElement("div",{onClick:n},"Add card"),c.a.createElement("div",null,"Change list color"),c.a.createElement("div",null,"Sort list by"),c.a.createElement("div",{onClick:a},"Delete list"))},ne=function(e){var t=e.provided,a=e.innerRef,r=e.taskList,l=e.taskListIdx,o=e.onListUpdated,s=e.onRemoveList,u=Object(n.useState)(Object(_.a)({},r)),d=Object(v.a)(u,2),m=d[0],b=d[1],k=Object(n.useState)(null),E=Object(v.a)(k,2),g=E[0],h=E[1],O=Object(n.useState)(!1),j=Object(v.a)(O,2),N=j[0],y=j[1],x=Object(i.h)().url,C=Object(n.useState)(!1),S=Object(v.a)(C,2),I=S[0],D=S[1],T=Object(n.useRef)(null);Object(n.useEffect)((function(){b(Object(_.a)({},r))}),[r]);var L=function(){D(!1);var e=w.getEmptyTask();h(e),y(!0)},A=function(e){h(Object(_.a)(Object(_.a)({},g),{},Object(z.a)({},e.target.name,e.target.value)))},R=function(e,t){if(e)o(e,t);else{if(m.title===r.title)return;o(m)}y(!1),h(null)},M=function(){var e=Object(p.a)(f.a.mark((function e(){var t,a,n,c=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:null,!g||!g.title){e.next=11;break}return(a=JSON.parse(JSON.stringify(m))).tasks.push(g),n=w.newActivity("Added this card to ".concat(a.title),'Added  <a href="#'.concat(x,"/").concat(g.id,'">').concat(g.title,"</a> to ").concat(a.title),g.id),e.next=7,R(a,n);case 7:if("clickedOutside"!==t){e.next=9;break}return e.abrupt("return");case 9:h(null),L();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();ee(T,(function(){N&&g&&g.title?M("clickedOutside"):B()}));var B=function(){h(null),y(!1)};return m&&c.a.createElement("div",Object.assign({className:"list-wrapper",ref:a},t.draggableProps),c.a.createElement("div",{className:"list"},c.a.createElement("div",Object.assign({className:"list-header"},t.dragHandleProps),m.title&&c.a.createElement(te,{name:"title",type:"h3",text:m.title,onChange:function(e){b(Object(_.a)(Object(_.a)({},m),{},Object(z.a)({},e.target.name,e.target.value)))},onInputBlur:R}),c.a.createElement("button",{className:"list-menu-btn clear-btn",onClick:function(){return D(!I)}},c.a.createElement(U.a,null)),I&&!N&&c.a.createElement(ae,{onRemoveList:function(){s(r.id)},onAddTask:L,onCloseMenu:function(){return D(!1)}})),c.a.createElement("div",{className:"overs"},c.a.createElement(J.c,{type:"task",droppableId:"".concat(l)},(function(e){return c.a.createElement("div",{className:"list-content custom-scrollbar",ref:e.innerRef},r.tasks.map((function(e,t){return c.a.createElement(Q,{key:e.id,task:e,index:t})})),N&&g&&c.a.createElement("div",{className:"add-task-wrapper ",ref:T},c.a.createElement(te,{name:"title",type:"p",text:g.title,onChange:A,isFocused:N,onSubmit:M,onEscape:B}),c.a.createElement("div",{className:"add-task-controls"},c.a.createElement("button",{onClick:M,className:"submit-btn"},"Add task"),c.a.createElement("button",{onClick:B,className:"clear-btn icon-lg"},c.a.createElement(V.d,null)))),e.placeholder)}))),c.a.createElement("div",{className:"list-footer"},!N&&!g&&c.a.createElement("a",{className:"clear-btn list-footer-btn",onClick:L},c.a.createElement("span",{className:"icon-lg add-icon"},c.a.createElement(V.a,null))," ",c.a.createElement("span",null,"Add new task")))))},ce=a(53),re=a.n(ce),le=a(97),oe=function(e){var t=e.task,a=e.labels,r=e.onCloseModal,l=e.onTaskUpdated,o=e.labelsUpdated,s=e.bounds,i=e.exceptionRef,u=Object(n.useState)(null),d=Object(v.a)(u,2),b=d[0],f=d[1],p=Object(n.useState)(!1),k=Object(v.a)(p,2),E=k[0],g=k[1],h=Object(n.useRef)(null);ee(h,(function(){r()}),i);var O=function(e){f(Object(_.a)(Object(_.a)({},b),{},Object(z.a)({},e.target.name,e.target.value)))},j=function(){var e=Object(m.a)(a),t=e.findIndex((function(e){return e.id===b.id}));e.splice(t,1,b),o(Object(m.a)(e),b),g(!1),f(null)};Object(n.useEffect)((function(){if(!E&&b){var e=JSON.parse(JSON.stringify(t)),a=e.labels.findIndex((function(e){return e.id===b.id}));-1!==a&&(e.labels.splice(a,1,b),l(e))}}),[E]);var N=function(e){if(b)return e.id===b.id};return c.a.createElement("div",{className:"pop-up labels",ref:h,style:s},c.a.createElement("div",{className:"pop-up-header"},c.a.createElement("span",{className:"pop-up-title"},"Labels"),c.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:r},c.a.createElement(V.d,null))),c.a.createElement("ul",null,a.map((function(e){return c.a.createElement("li",{className:"label-container",key:e.id},c.a.createElement("span",{className:"card-label",style:{backgroundColor:e.color},onClick:function(){return function(e){var a=JSON.parse(JSON.stringify(t));if(a.labels.find((function(t){return t.id===e.id}))){var n=a.labels.findIndex((function(t){return t.id===e.id}));a.labels.splice(n,1)}else a.labels.push(e);l(a)}(e)}},!N(e)&&c.a.createElement("span",{className:"label-title"},e.title),N(e)&&E&&c.a.createElement(te,{type:"p",name:"title",isFocused:E,text:e.title,onChange:O,onInputBlur:j}),c.a.createElement("span",{className:"label-selected"})),c.a.createElement("button",{className:"clear-btn",onClick:function(){return function(e){null!==b&&b.id===e.id?g(!1):(f(Object(_.a)({},e)),g(!0))}(e)}},c.a.createElement(le.a,null)))}))))},se=a(52),ie=a.n(se),ue=a(104),de=(a(172),function(e){var t=e.task,a=e.onTaskUpdated,r=e.onCloseModal,l=e.bounds,o=e.exceptionRef,s=Object(n.useState)(new Date),u=Object(v.a)(s,2),d=u[0],m=u[1],b=Object(i.h)().url,k=Object(n.useRef)(null);Object(n.useEffect)((function(){if(t.dueDate){var e=new Date(t.dueDate);m(e)}}),[]),ee(k,(function(){r()}),o);var E=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=ie()(new Date(e)).format("MMM Do");return t.dueDate?w.newActivity("Changed the due date of this card to  ".concat(n),'Changed <a href="#'.concat(b,'">').concat(t.title,"</a> to be due at ").concat(n),t.id):a?w.newActivity("Removed the due date from this card",'Removed <a href="'.concat(b,'">').concat(t.title,"</a> due date"),t.id):w.newActivity("Set this card to be due at ".concat(n),'Set <a href="'.concat(b,'">').concat(t.title,"</a> to be due at ").concat(n," "),t.id)},g=function(){var e=Object(p.a)(f.a.mark((function e(){var n,c,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=d.getTime())!==t.dueDate){e.next=3;break}return e.abrupt("return");case 3:return(c=JSON.parse(JSON.stringify(t))).dueDate=n,l=E(n),e.next=8,a(c,l);case 8:r();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"pop-up",style:l,ref:k},c.a.createElement("div",{className:"pop-up-header"},c.a.createElement("span",{className:"pop-up-title"},"Date"),c.a.createElement("button",{onClick:r,className:"pop-up-close-btn clear-btn icon-lg"},c.a.createElement(V.d,null))),c.a.createElement(ue.a,{onChange:function(e){m(e)},value:d}),c.a.createElement("button",{onClick:g,className:"submit-btn add-date-btn"},"Save"))});function me(e){return function(t){t({type:"TOGGLE_INITIAL_ADDITION",isInitial:e})}}var be=function(e){var t=e.task,a=e.onTaskUpdated,r=e.onCloseModal,l=e.bounds,s=e.sidebarRef,u=Object(n.useState)({}),d=Object(v.a)(u,2),m=d[0],b=d[1],f=Object(n.useRef)(null),p=Object(i.h)().url,k=Object(o.c)();Object(n.useEffect)((function(){var e=w.getEmptyCheckList();b(Object(_.a)({},e))}),[]),ee(f,(function(){r()}),s);var E=function(){var e=JSON.parse(JSON.stringify(t)),n=Object(_.a)({},m);e.checklists.push(n);var c=w.newActivity("Added ".concat(m.title,"  on this card"),"Added ".concat(m.title,' on <a href="#').concat(p,'">').concat(t.title,"</a>"),t.id);a(e,c),k(me(!0)),r()};return c.a.createElement("div",{className:"pop-up",style:l,ref:f},c.a.createElement("div",{className:"pop-up-header"},c.a.createElement("span",{className:"pop-up-title"},"Add checklist"),c.a.createElement("button",{className:"pop-up-close-btn clear-btn"})),c.a.createElement(te,{isFocused:!0,onChange:function(e){b(Object(_.a)(Object(_.a)({},m),{},Object(z.a)({},e.target.name,e.target.value)))},onSubmit:E,type:"p",name:"title"}),c.a.createElement("button",{onClick:E,className:"submit-btn add-date-btn"},"Save"))},fe=a(98),pe=a.n(fe),ve={uploadImg:function(e){console.log("yes");var t="https://api.cloudinary.com/v1_1/".concat("dhz1jk4k6","/image/upload"),a=new FormData;return a.append("file",e.target.files[0]),a.append("upload_preset","jtim2mm3"),fetch(t,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.error(e)}))}};function ke(){var e=Object(F.a)(["\n","\n"]);return ke=function(){return e},e}function Ee(){var e=Object(F.a)(["\n","\n"]);return Ee=function(){return e},e}var ge=q.a.div(Ee(),(function(e){return"color"===e.cover.type?{backgroundColor:e.cover.background}:{backgroundImage:"url("+e.cover.background+")",backgroundSize:"cover"}})),he=q.a.div(ke(),(function(e){return"color"===e.cover.type?{backgroundColor:e.cover.background}:{backgroundImage:"light"===e.cover.theme?"linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),url("+e.cover.background+")":"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),url("+e.cover.background+")",backgroundSize:"cover",backgroundPosition:"50%"}})),Oe=function(e){var t=e.task,a=e.onCloseModal,r=e.onTaskUpdated,l=e.bounds,o=e.exceptionRef,s=Object(n.useState)(t.cover),i=Object(v.a)(s,2),u=i[0],d=i[1],m=Object(n.useState)(!1),b=Object(v.a)(m,2),k=b[0],E=b[1],g=Object(n.useRef)(null);ee(g,(function(){a()}),o);var h=function(e){var a=Object(_.a)({},t);e.id?(d(Object(_.a)(Object(_.a)({},u),{},{background:e.url,type:"img"})),a.cover.type="img",a.cover.background=e.url):(d(Object(_.a)(Object(_.a)({},u),{},{background:e,type:"color"})),a.cover.type="color",a.cover.background=e),r(a)},O=function(e){if(t.cover.background){d(Object(_.a)(Object(_.a)({},u),{},{isFull:e}));var a=Object(_.a)({},t);a.cover.isFull=e,r(a)}},j=function(e){if(e!==u.theme){d(Object(_.a)(Object(_.a)({},u),{},{theme:e}));var a=Object(_.a)({},t);a.cover.theme=e,r(a)}},N=function(){var e=Object(p.a)(f.a.mark((function e(a){var n,c,l,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("yes mame"),E(!0),e.next=4,ve.uploadImg(a);case 4:n=e.sent,c=n.url,d(Object(_.a)(Object(_.a)({},u),{},{background:c,type:"img"})),l=Object(_.a)({},t),o={id:x.makeId(),url:c,isCover:!0},l.images.push(o),l.cover.background=c,l.cover.type="img",r(l),E(!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"pop-up cover-picker ".concat(l?"":"absolute"),ref:g,style:l},c.a.createElement("div",{className:"pop-up-header"},c.a.createElement("span",{className:"pop-up-title"},"Cover"),c.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:a},c.a.createElement(V.d,null))),c.a.createElement("span",{className:"pop-up-title"},"Size"),c.a.createElement("div",{className:"cover-size-picker"},c.a.createElement(he,{cover:u,className:"cover-size "+(t.cover.background?u.isFull?"selected":"":"disabled"),onClick:function(){return O(!0)}},c.a.createElement("div",{className:"line-wrapper ".concat("img"===t.cover.type&&"dark"===t.cover.theme?"dark":"")},c.a.createElement("div",{className:"line line1"}),c.a.createElement("div",{className:"line line2"}),c.a.createElement("div",{className:"line line3"}))),c.a.createElement("div",{className:"cover-size half "+(t.cover.background?u.isFull?"":"selected":"disabled"),onClick:function(){return O(!1)}},c.a.createElement(ge,{className:"half",cover:u}),c.a.createElement("div",{className:"line-wrapper"},c.a.createElement("div",{className:"line line1"}),c.a.createElement("div",{className:"line line2"}),c.a.createElement("div",{className:"line line3"})))),t.cover.background&&c.a.createElement("button",{className:"modal-btn",onClick:function(){d(Object(_.a)(Object(_.a)({},u),{},{background:null,type:null,isFull:null,theme:null}));var e=Object(_.a)({},t);e.cover=Object(_.a)(Object(_.a)({},e.cover),{},{background:null,type:null,isFull:null,theme:null}),r(e),a()}},"Remove Cover"),"img"===u.type&&u.isFull&&c.a.createElement("div",{className:"cover-txt-color"},c.a.createElement("span",{className:"pop-up-title"},"Text color"),c.a.createElement("div",{className:"flex justify-center"},c.a.createElement("div",{onClick:function(){return j("light")},className:"cover-txt light",style:{backgroundImage:"linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),url(".concat(u.background,")")}},c.a.createElement("h3",null,t.title)),c.a.createElement("div",{onClick:function(){return j("dark")},className:"cover-txt dark",style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),url(".concat(u.background,")")}},c.a.createElement("h3",null,t.title)))),c.a.createElement("span",{className:"pop-up-title"},"Colors"),c.a.createElement("div",{className:"cover-palette"},["#61bd4f","#f2d600","#ff9f1a","#c377e0","#eb5a46","#055a8c","#705cc1","#00c2e0","#ff78cb"].map((function(e,t){return c.a.createElement("span",{className:"cover-color "+(e===u.background?"selected":""),style:{backgroundColor:e},key:t,onClick:function(){return h(e)}})}))),t.images.length>0&&c.a.createElement("span",{className:"pop-up-title"},"Images"),t.images.length>0&&c.a.createElement("div",{className:"cover-img-wrapper"},t.images.map((function(e){return c.a.createElement("span",{className:"cover-img-preview "+(e.url+e.id===u.background+e.id?"selected":""),style:{backgroundImage:"url(".concat(e.url,")")},onClick:function(){return h(e)},key:e.id})}))),c.a.createElement("div",{className:"upload-img-container flex space-between align-center"},c.a.createElement("p",null,"Upload image:"),c.a.createElement("input",{onChange:N,id:"file",type:"file",title:"Upload Image"}),c.a.createElement("label",{className:"btn-3",htmlFor:"file"},k?c.a.createElement(pe.a,{height:9,width:5,color:"#2c3e50",loading:k}):c.a.createElement("span",null,"Upload"))),c.a.createElement("hr",{className:"divider"}))},je=function(e){var t=e.task,a=e.labels,r=e.onUpdateTask,l=e.onLabelsUpdated,o=e.onAddActivity,s=Object(n.useRef)(null),i=Object(n.useState)(null),u=Object(v.a)(i,2),d=u[0],m=u[1],b=Object(n.useState)(null),f=Object(v.a)(b,2),p=f[0],k=f[1],E=Object(n.useRef)(null),g=function(e,t){E.current=e.target.id;var a=e.target.getBoundingClientRect(),n=a.top,c=a.left,r=a.height;window.innerWidth-c-304<50&&window.innerWidth>770?k({top:n+r,left:c-100}):k({top:n+r,left:c-50}),t===d?(m(null),k(null),E.current=null):m(t)},h=Object(n.useCallback)((function(){if(E.current){var e=document.getElementById(E.current).getBoundingClientRect(),t=e.top,a=e.left,n=e.height,c=window.innerWidth-a-304;k(c<50?{top:t+n,right:0}:{top:t+n,left:a})}}),[]);Object(n.useEffect)((function(){d?window.addEventListener("resize",h):window.removeEventListener("resize",h)}),[d]);var O=function(){m(null),E.current=null};return c.a.createElement("div",{className:"modal-sidebar",ref:s},c.a.createElement("h3",null,"Add to card"),c.a.createElement("button",{id:"sidebar-labels",className:"modal-btn",onClick:function(e){return g(e,"isLabelActive")}},"Labels"),"isLabelActive"===d&&c.a.createElement(oe,{bounds:p,task:t,labels:a,onCloseModal:O,onTaskUpdated:r,labelsUpdated:l,exceptionRef:s}),c.a.createElement("button",{className:"modal-btn"},"Members"),c.a.createElement("button",{id:"sidebar-checklist",className:"modal-btn",onClick:function(e){return g(e,"isChecklistActive")}},"Checklist"),"isChecklistActive"===d&&c.a.createElement(be,{task:t,bounds:p,onTaskUpdated:r,onCloseModal:O,exceptionRef:s}),c.a.createElement("button",{id:"sidebar-date",className:"modal-btn",onClick:function(e){return g(e,"isDueDateActive")}},"Due date"),"isDueDateActive"===d&&c.a.createElement(de,{bounds:p,task:t,onTaskUpdated:r,onAddActivity:o,onCloseModal:O,exceptionRef:s}),!t.cover.background&&c.a.createElement("button",{id:"sidebar-cover",className:"modal-btn",onClick:function(e){return g(e,"isCoverActive")}},"Cover"),"isCoverActive"===d&&c.a.createElement(Oe,{bounds:p,exceptionRef:s,task:t,onCloseModal:O,onTaskUpdated:r}))},Ne=function(e){var t=e.item,a=e.onSubmit,r=e.onRemoveItem,l=e.task,o=Object(n.useState)(Object(_.a)({},t)),s=Object(v.a)(o,2),u=s[0],d=s[1],m=Object(n.useState)(!1),b=Object(v.a)(m,2),f=b[0],p=b[1],k=Object(n.useState)(!1),E=Object(v.a)(k,2),g=E[0],h=E[1],O=Object(n.useState)(""),j=Object(v.a)(O,2),N=j[0],y=j[1],x=Object(n.useRef)(null),C=Object(n.useRef)(!0),S=Object(i.h)().url;ee(x,(function(){f&&(console.log("imhere",f),t.title!==u.title&&(y(u.title),d((function(e){return Object(_.a)(Object(_.a)({},e),{},{title:t.title})})),h(!0)),p(!1))})),Object(n.useEffect)((function(){if(C.current)C.current=!1;else{var e=w.newActivity("".concat(u.isDone?"Completed  ".concat(t.title," on this card"):"Marked ".concat(t.title," incomplete on this card")),"".concat(u.isDone?"Completed  ".concat(t.title,' on <a href="#').concat(S,'">').concat(l.title,"</a>"):"Marked ".concat(t.title,' incomplete on <a href="#').concat(S,'">').concat(l.title,"</a>")),l.id);T(e)}}),[u.isDone]);var I=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;d(Object(_.a)(Object(_.a)({},u),{},Object(z.a)({},n,a)))},D=function(){p(!1)},T=function(e){u.title?(p(!1),h(!1),a(Object(_.a)({},u),e)):p(!0)};return c.a.createElement("div",{className:"checklist-item"},c.a.createElement("div",{className:"checklist-item-editor  "+(u.isDone?"done":"")},u&&!f&&c.a.createElement("input",{type:"checkbox",name:"isDone",checked:u.isDone,onChange:I}),c.a.createElement("div",{className:"item-title",onClick:function(){return p(!0)},ref:x},c.a.createElement(te,{text:u.title,onChange:I,onSubmit:T,onEscape:D,isFocused:f,type:"p",name:"title"}),f&&c.a.createElement("div",{className:"add-item-controls"},c.a.createElement("button",{className:"submit-btn"},"Save"),c.a.createElement("button",{className:"clear-btn icon-lg",onClick:D},c.a.createElement(V.d,null)),c.a.createElement("div",{className:"spacer",onClick:D}))),!f&&c.a.createElement("button",{className:"remove-item-btn clear-btn",onClick:function(){r(u.id)}},c.a.createElement(U.b,null))),g&&!f&&c.a.createElement("p",{className:"checklist-user-msg"},c.a.createElement("span",null,"You have unsaved edits on this field."),c.a.createElement("button",{className:"clear-btn",onClick:function(){d((function(e){return Object(_.a)(Object(_.a)({},e),{},{title:N})})),p(!0)}},"View edits"),c.a.createElement("button",{className:"clear-btn",onClick:function(){h(!1)}},"Discard")))},ye=a(100),xe=(a(176),function(e){var t=e.task,a=e.checklist,r=e.onUpdateTask,l=Object(n.useState)(null),s=Object(v.a)(l,2),u=s[0],d=s[1],m=Object(n.useState)(a.title),b=Object(v.a)(m,2),k=b[0],E=b[1],g=Object(n.useState)(null),h=Object(v.a)(g,2),O=h[0],j=h[1],N=Object(n.useState)(!1),y=Object(v.a)(N,2),x=y[0],C=y[1],S=Object(n.useRef)(null),I=Object(i.h)().url,D=Object(o.c)(),T=Object(o.d)((function(e){return e.general.isInitialAddition}));Object(n.useEffect)((function(){T&&L()}),[]),Object(n.useEffect)((function(){var e=a.listItems.reduce((function(e,t){return t.isDone&&e++,e}),0),t=Math.round(100*e/a.listItems.length);j(t)}),[a]);var L=function(){var e=w.getEmptyListItem();d(e),C(!0),T&&D(me(!1))},A=function(){C(!1),d(null)};ee(S,(function(){x&&(C(!1),d(null))}));var R=function(e){var t=Object(_.a)({},a),n=t.listItems.findIndex((function(t){return t.id===e}));-1!==n&&t.listItems.splice(n,1),B(t)},M=function(){var e=Object(p.a)(f.a.mark((function e(t,n){var c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Object(_.a)({},a),!t){e.next=9;break}if(-1===(r=c.listItems.findIndex((function(e){return e.id===t.id})))){e.next=7;break}return c.listItems.splice(r,1,t),e.next=7,B(c,n);case 7:e.next=16;break;case 9:if(u.title){e.next=12;break}return A(),e.abrupt("return");case 12:return c.listItems.push(u),e.next=15,B(c);case 15:L();case 16:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),B=function(e,n){var c=JSON.parse(JSON.stringify(t));if(e){var l=c.checklists.findIndex((function(t){return t.id===e.id}));c.checklists.splice(l,1,e)}else c.checklists=c.checklists.filter((function(e){return e.id!==a.id})),n=w.newActivity("Removed ".concat(a.title,"  on this card"),"Removed ".concat(a.title,' on <a href="#').concat(I,'">').concat(t.title,"</a>"),t.id);r(c,n),C(!1),d(null)};return c.a.createElement("div",{className:"task-checklist"},c.a.createElement("div",{className:"section-title flex align-center"},c.a.createElement(te,{text:k,onChange:function(e){E(e.target.value)},onInputBlur:function(){var e=Object(_.a)({},a);e.title=k;var n=w.newActivity("Renamed ".concat(e.title," from (").concat(a.title,")"),"Renamed ".concat(e.title," from (").concat(a.title,') on <a href="#').concat(I,'">').concat(t.title,"</a>"),t.id);B(e,n)},type:"h3"}),c.a.createElement("button",{className:"modal-btn",onClick:function(){return B()}},"Delete")),a.listItems.length>0&&c.a.createElement(ye.Progress,{percent:O}),a&&a.listItems.map((function(e){return c.a.createElement(Ne,{key:e.id,onSubmit:M,onRemoveItem:R,item:e,task:t})})),u&&x&&c.a.createElement("div",{className:"add-item",ref:S},c.a.createElement(te,{onChange:function(e){d(Object(_.a)(Object(_.a)({},u),{},Object(z.a)({},e.target.name,e.target.value)))},onSubmit:M,onEscape:A,isFocused:x,type:"p",name:"title"}),c.a.createElement("div",{className:"add-item-controls"},c.a.createElement("button",{className:"submit-btn",onClick:function(){return M()}},"Save"),c.a.createElement("button",{className:"clear-btn icon-lg",onClick:A},c.a.createElement(V.d,null)),c.a.createElement("div",{className:"spacer",onClick:A}))),!x&&c.a.createElement("button",{className:"modal-btn",onClick:L},"Add an item"))}),we={lastDay:"[Yesterday at] LT",sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",lastWeek:"[last] dddd [at] LT",nextWeek:"dddd [at] LT",sameElse:"MMMM D [at] LT"},Ce=function(e){var t=e.taskId,a=void 0===t?null:t,r=Object(k.a)((function(e){return e.board.currBoard.activities}),(function(e){return a?e.filter((function(e){return e.taskId===a})):e})),l=Object(o.d)(r),s=Object(n.useState)(!0),i=Object(v.a)(s,2),u=i[0],d=i[1],m=Object(n.useState)(!0),b=Object(v.a)(m,2),f=b[0],p=b[1],E=Object(n.useState)(l.slice(0,5)),g=Object(v.a)(E,2),h=g[0],O=g[1],j=Object(n.useState)(5),N=Object(v.a)(j,2),y=N[0],x=N[1];Object(n.useEffect)((function(){O(l.slice(0,5)),p(!0),x(5)}),[l.length]);return c.a.createElement("div",{className:"activity-log"},a&&c.a.createElement("button",{className:"modal-btn",onClick:function(){d((function(e){return!e}))}},u?"Hide details":"Show details"),u&&h.length>0&&h.map((function(e){return c.a.createElement("div",{className:"activity-content",key:e.id},a?c.a.createElement("p",{className:"activity-desc",dangerouslySetInnerHTML:{__html:e.cardTxt}}):c.a.createElement("p",{className:"activity-desc",dangerouslySetInnerHTML:{__html:e.boardTxt}}),c.a.createElement(W.a,{calendar:we},e.date))})),u&&f&&l.length>5&&c.a.createElement("button",{className:"clear-btn show-more-btn",onClick:function(){console.log("firstinDEX:",y);var e=y+5,t=e<=l.length-1;console.log("activities: ",l," index: ",y," newIndex: ",e);var a=h.concat(l.slice(y,e));x(e),O(a),p(t)}}," Load More "))},Se={lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",sameElse:"MMMM D"},Ie=function(){var e=Object(o.c)(),t=Object(o.d)((function(e){return e.board.currTask})),a=Object(o.d)((function(e){return e.board.currBoard})),r=Object(n.useState)(null),l=Object(v.a)(r,2),s=l[0],u=l[1],d=Object(n.useState)(null),m=Object(v.a)(d,2),b=m[0],k=m[1],E=Object(n.useRef)(null),g=Object(n.useRef)(null),h=Object(n.useRef)(null),O=Object(i.g)().taskId,j=Object(i.f)(),N=Object(i.h)().url;Object(n.useEffect)((function(){(function(){var t=Object(p.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(M(O));case 2:t.sent||j.push("/board/".concat(a._id));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(n.useEffect)((function(){return document.body.style.overflowX="hidden",function(){document.body.style.overflowX="unset"}}),[]),Object(n.useEffect)((function(){t&&k(Object(_.a)({},t))}),[t]);var y=function(){j.push("/board/".concat(a._id))};ee(E,(function(){console.log("paam ahat"),y()})),ee(g,(function(){console.log("paam ahat"),u(null)}));var x=function(e){k(Object(_.a)(Object(_.a)({},b),{},Object(z.a)({},e.target.name,e.target.value)))},C=function(){var e=Object(p.a)(f.a.mark((function e(t){var a,n=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.length>1&&void 0!==n[1]?n[1]:null,!t){e.next=6;break}return e.next=4,S(Object(_.a)({},t),a);case 4:e.next=7;break;case 6:S(Object(_.a)({},b));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var t=Object(p.a)(f.a.mark((function t(n,c){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(B(n)),r=JSON.parse(JSON.stringify(a)),c&&r.activities.unshift(c),r.taskLists.forEach((function(e){var t=e.tasks.findIndex((function(e){return e.id===n.id}));-1!==t&&e.tasks.splice(t,1,n)})),t.next=6,e(R(r));case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),I=function(t,n){var c=JSON.parse(JSON.stringify(a));c.labels=t,c.taskLists.forEach((function(e){e.tasks.forEach((function(e){var t=e.labels.find((function(e){return e.id===n.id}));t&&(t.title=n.title)}))})),e(R(c))},D=function(){var t=Object(p.a)(f.a.mark((function t(n){var c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(c=JSON.parse(JSON.stringify(a))).activities.unshift(n),t.next=4,e(R(c));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T=function(e,t){var a=e.target;if(h.current=a,t===s)return u(null),void console.log("yes same");u(t)},L=Object(n.useMemo)((function(){if(t){console.log("hi");var e=new Date;return e.setHours(0,0,0,0),e.setDate(e.getDate()+1),t.isDone?{class:"task-complete",txt:"Complete"}:e.getTime()===t.dueDate?{class:"due-soon",txt:"Due soon"}:t.dueDate<=Date.now()?{class:"over-due",txt:"Over due"}:""}}),[t]);return c.a.createElement("div",{className:"task-details"},c.a.createElement("div",{className:"cover"}),b&&t&&c.a.createElement("div",{className:"task-modal",ref:E},b.cover.background&&c.a.createElement(re.a,{src:b.cover.background,crossOrigin:"anonymous",format:"hex"},(function(e){var t=e.data;return c.a.createElement("div",{className:"modal-header ",style:{backgroundImage:"url(".concat(b.cover.background,")"),backgroundColor:t||b.cover.background}},b.cover.background&&c.a.createElement("button",{className:"modal-btn",onClick:function(e){return T(e,"coverPicker")}},"Cover"),"coverPicker"===s&&c.a.createElement(Oe,{task:b,onTaskUpdated:C,onCloseModal:function(){return T("coverPicker")},wrapperRef:g,exceptionRef:h}))})),c.a.createElement("a",{onClick:y,className:"modal-close-btn icon-lg"},c.a.createElement(V.d,null)),c.a.createElement("div",{className:"modal-module"},c.a.createElement("div",{className:"task-title"},c.a.createElement(te,{type:"h3",name:"title",text:b.title,onChange:x,onInputBlur:C}))),c.a.createElement("div",{className:"task-content"},c.a.createElement("div",{className:"left-side"},c.a.createElement("div",{className:"modal-module"},c.a.createElement("div",{className:"task-labels-date"},b.labels.length>0&&c.a.createElement("div",{className:"task-labels"},c.a.createElement("h3",{className:"task-item-title"},"Labels"),c.a.createElement("div",{className:"task-labels-list"},c.a.createElement(G,{expandMode:!0,onLabelClicked:function(e){return T(e,"labelPicker")},labels:b.labels})),"labelPicker"===s&&c.a.createElement(oe,{task:b,onTaskUpdated:C,labelsUpdated:I,onCloseModal:function(){return T("labelPicker")},labels:a.labels,exceptionRef:h})),b.dueDate&&c.a.createElement("div",{className:"task-due-date"},c.a.createElement("h3",{className:"task-item-title"},"Due date"),c.a.createElement("div",{className:"modal-btn",onClick:function(e){return T(e,"datePicker")}},c.a.createElement("label",null,c.a.createElement("input",{className:"css-checkbox",type:"checkbox",name:"isDone",checked:b.isDone,onChange:function(e){e.stopPropagation(),e.preventDefault();var t=e.target.checked,a=Object(_.a)({},b);a.isDone=t;var n=w.newActivity("Marked the due date ".concat(a.isDone?"complete":"incomplete"),"Marked the due date ".concat(a.isDone?"complete":"incomplete"," on <a href='#").concat(N,"'>").concat(a.title,"</a>"),a.id);S(a,n)}}),c.a.createElement("i",null)),c.a.createElement(W.a,{calendar:Se,date:b.dueDate}),c.a.createElement("span",{className:"task-badge "+(L?L.class:"")},L.txt),c.a.createElement(V.b,{className:"icon-lg"})),"datePicker"===s&&c.a.createElement(de,{task:b,onTaskUpdated:C,exceptionRef:h,onCloseModal:function(){return T("datePicker")}})))),c.a.createElement("div",{className:"modal-module"},c.a.createElement("div",{className:"task-description"},c.a.createElement("h3",{className:"section-title"},"Description"),c.a.createElement(te,{type:"p",name:"description",text:b.description,onChange:x,onInputBlur:C,isWide:!0,placeholder:"Add a more detailed description\u2026"}))),b.checklists.length>0&&c.a.createElement("div",{className:"modal-module"},b.checklists.map((function(e){return c.a.createElement(xe,{checklist:e,key:e.id,task:b,onUpdateTask:C})}))),c.a.createElement("div",{className:"modal-module"},c.a.createElement("h3",{className:"section-title"},"Activity"),c.a.createElement(Ce,{taskId:b.id}))),c.a.createElement("div",{className:"right-side"},a&&c.a.createElement(je,{task:b,labels:a.labels,onUpdateTask:C,onLabelsUpdated:I,onAddActivity:D})))))},De=function(e){var t=e.board,a=e.onBoardUpdated,r=Object(n.useState)(null),l=Object(v.a)(r,2),o=l[0],s=l[1],i=Object(n.useRef)(null),u=function(){if(o.title){var e=JSON.parse(JSON.stringify(t));e.taskLists.push(o),a(e),s(null)}};return ee(i,(function(){s(null)})),c.a.createElement("div",{className:"list-wrapper "},o?c.a.createElement("div",{className:"list add-list",ref:i},c.a.createElement(te,{isFocused:!0,onChange:function(e){s(Object(_.a)(Object(_.a)({},o),{},Object(z.a)({},e.target.name,e.target.value)))},onSubmit:u,name:"title",type:"p"}),c.a.createElement("div",{className:"add-list-controls"},c.a.createElement("button",{className:"submit-btn",onClick:u},"Add List"),c.a.createElement("button",{onClick:function(){return s(null)},className:"clear-btn icon-lg"},c.a.createElement(V.d,null)))):c.a.createElement("button",{className:"modal-btn",onClick:function(){var e=w.getEmptyList();s(e)}},"Add another list "))},Te=a(102),Le=a(101),Ae=a.n(Le),Re=a(37);function Me(){var e=Object(F.a)(["\n  position: fixed;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n"]);return Me=function(){return e},e}var Be=Object(Re.css)(Me()),Je=function(e){var t=e.onGoBack,a=e.board,r=e.onBoardUpdated,l=Object(n.useState)(null),o=Object(v.a)(l,2),s=o[0],i=o[1],u=Object(n.useState)(!1),d=Object(v.a)(u,2),m=d[0],b=(d[1],function(e,t){if(e!==a.style.background){var n=JSON.parse(JSON.stringify(a));n.style={background:e,type:t},r(n)}});return c.a.createElement("div",{className:"board-menu-bg-picker"},console.log("rednered"),c.a.createElement("button",{className:"pop-up-back-btn clear-btn icon-lg",onClick:function(){s?i(null):t()}},c.a.createElement(V.c,null)),!s&&c.a.createElement("div",{className:"bg-picker-controls"},c.a.createElement("div",{className:"bg-picker-btn",onClick:function(){return i("photos")}},c.a.createElement("span",{className:"photos image"}),c.a.createElement("span",{className:"bg-btn-title"},"Photos")),c.a.createElement("div",{className:"bg-picker-btn",onClick:function(){return i("colors")}},c.a.createElement("span",{className:"colors image"}),c.a.createElement("span",{className:"bg-btn-title"},"Colors"))),c.a.createElement(Ae.a,{css:Be,size:15,color:"#2c3e50",loading:m}),"photos"===s&&c.a.createElement("div",{className:"bg-section-wrapper"},["https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389449/Taskflow%20backgrounds/cacjncpn6qp4qivznyaj.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389449/Taskflow%20backgrounds/jukyghlsvncbyovcqvce.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389422/Taskflow%20backgrounds/2.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389420/Taskflow%20backgrounds/itjhqv6u26jigvxmzwsi.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389420/Taskflow%20backgrounds/sltgv2lrkmcbivdxxmb3.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389410/Taskflow%20backgrounds/yeozivyoaywjmj4hciwp.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389409/Taskflow%20backgrounds/idhd2wg760g7xa8vsze2.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389400/Taskflow%20backgrounds/t9jpmstlb7oaijmbynmw.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389394/Taskflow%20backgrounds/ponbl1heu65x22wus4ui.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389391/Taskflow%20backgrounds/nnobztxqgr82swa61ne4.jpg"].map((function(e,t){return c.a.createElement("span",{style:{backgroundImage:"url(".concat(e,")")},className:"bg-item",key:t,onClick:function(){return b(e,"img")}})}))),"colors"===s&&c.a.createElement("div",{className:"bg-section-wrapper"},["#61bd4f","#f2d600","#ff9f1a","#c377e0","#eb5a46","#055a8c","#705cc1","#00c2e0","#ff78cb"].map((function(e,t){return c.a.createElement("span",{className:"bg-item",style:{backgroundColor:e},key:t,onClick:function(){return b(e,"color")}})}))))},Ue=function(e){var t=e.isMenuOpen,a=e.closeMenu,r=e.menuBtnRef,l=e.board,o=e.onBoardUpdated,s=Object(i.f)(),u=Object(n.useRef)(null),d=Object(n.useState)(null),m=Object(v.a)(d,2),b=m[0],f=m[1],p=function(e){switch(e){case"backgroundPicker":f(Object(_.a)(Object(_.a)({},b),{},{type:e,title:"Background"}))}};return ee(u,(function(){t&&a()}),r),Object(n.useEffect)((function(){t&&f(null)}),[t]),Object(n.useEffect)((function(){return s.listen((function(e){u.current.classList.contains("menu-open")&&a()}))}),[s]),c.a.createElement("div",{className:"board-menu ".concat(t?"menu-open":"  "),ref:u},c.a.createElement("div",{className:"pop-up-header"},c.a.createElement("h3",null,b?b.title:"Menu"),c.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:a},c.a.createElement(V.d,null))),b?c.a.createElement("div",{className:"board-menu-content"},"backgroundPicker"===b.type&&c.a.createElement(Je,{onGoBack:function(){f(null)},board:l,onBoardUpdated:o})):c.a.createElement("div",{className:"board-menu-content"},c.a.createElement("div",{className:"board-menu-nav"},c.a.createElement("button",{className:"clear-btn board-menu-nav-btn",onClick:function(){return p("backgroundPicker")}},"Change background"),c.a.createElement("button",{className:"clear-btn board-menu-nav-btn",onClick:function(){return p("boardName")}},"Change board name"),c.a.createElement("button",{className:"clear-btn board-menu-nav-btn"},"Delete board")),c.a.createElement("div",null,c.a.createElement("div",{className:"section-title"},c.a.createElement(Te.a,{className:"icon-sm"}),c.a.createElement("h4",{className:""},"Activity")))))},ze=function(){var e=Object(i.g)().boardId,t=Object(i.h)().path,a=Object(i.f)(),r=Object(i.h)().url,l=Object(n.useRef)(!0),s=Object(n.useRef)(null),u=Object(o.c)(),d=Object(o.d)(E),b=Object(n.useState)(!1),k=Object(v.a)(b,2),g=k[0],h=k[1];Object(n.useEffect)((function(){(function(){var t=Object(p.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u(A(e));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),a.push("/boards");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(n.useEffect)((function(){l.current&&d&&(console.log("board.",d._id),L.setup(),L.emit("board topic",d._id),L.on("update board",N),l.current=!1)}),[d]),Object(n.useEffect)((function(){return function(){L.off("update board",N),L.terminate()}}),[]);var O=function(){var e=Object(p.a)(f.a.mark((function e(t){var a,n,c,r=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:null,n=JSON.parse(JSON.stringify(d)),a&&n.activities.unshift(a),c=n.taskLists.findIndex((function(e){return e.id===t.id})),n.taskLists.splice(c,1,t),e.next=7,u(R(n));case 7:console.log("adterupdatelist");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=Object(n.useCallback)((function(e){u(R(e))}),[u]),N=function(e){u(function(e){return function(t){t({type:"SET_BOARD",currBoard:e})}}(e))},y=function(e){var t=JSON.parse(JSON.stringify(d)),a=t.taskLists.findIndex((function(t){return t.id===e}));t.taskLists.splice(a,1),j(t)},C=function(){h((function(e){return!e}))};return console.log("rendered"),d?c.a.createElement("section",{className:"board-details",style:"color"===d.style.type?{backgroundColor:"".concat(d.style.background)}:{backgroundImage:"url(".concat(d.style.background,")")}},c.a.createElement("div",{className:"board-header"},c.a.createElement("button",null,"button2"),c.a.createElement("button",{className:"clear-btn open-menu-btn",onClick:C,ref:s},c.a.createElement("span",{className:"icon-sm"},c.a.createElement(U.a,null)),c.a.createElement("span",null,"Menu"))),c.a.createElement(Ue,{isMenuOpen:g,closeMenu:C,menuBtnRef:s,board:d,onBoardUpdated:j}),d&&c.a.createElement(J.a,{onDragEnd:function(e){var t=e.source,a=e.destination;if(a&&(t.index!==a.index||t.droppableId!==a.droppableId)){var n=Object(m.a)(d.taskLists),c=JSON.parse(JSON.stringify(d));if(t.droppableId===a.droppableId&&"board"===t.droppableId){var l=x.reorder(n,t.index,a.index);c.taskLists=l}else{var o=+t.droppableId,s=+a.droppableId;if(o===s){var i=x.reorder(n[o].tasks,t.index,a.index);c.taskLists[o].tasks=i}else{var u=x.move(n[o].tasks,n[s].tasks,t,a);c.taskLists[o].tasks=u[o],c.taskLists[s].tasks=u[s];var b={fromList:n[o].title,toList:n[s].title,task:n[o].tasks[t.index]},f=b.fromList,p=b.toList,v=b.task,k=w.newActivity("Moved this card from ".concat(f," to ").concat(p),'Moved  <a href="#'.concat(r,"/").concat(v.id,'">').concat(v.title,"</a> from ").concat(f," to ").concat(p),v.id);c.activities.unshift(k)}}N(c),j(c)}}},c.a.createElement(J.c,{droppableId:"board",type:"lists",direction:"horizontal"},(function(e,t){return c.a.createElement("div",Object.assign({className:"list-container",ref:e.innerRef},e.droppableProps),d.taskLists&&d.taskLists.map((function(e,t){return c.a.createElement(J.b,{key:e.id,draggableId:e.id,index:t,type:"lists"},(function(a,n){return c.a.createElement(ne,{taskListIdx:t,taskList:e,onRemoveList:y,onListUpdated:O,innerRef:a.innerRef,provided:a})}))})),e.placeholder,c.a.createElement(De,{board:d,onBoardUpdated:j}))}))),d&&c.a.createElement(i.a,{exact:!0,path:"".concat(t,"/:taskId"),component:Ie})):c.a.createElement("div",{style:{paddingTop:"50px"}},"baba")},_e=function(){var e=Object(i.f)();console.log("history",e);var t=Object(o.d)((function(e){return e.board.boards})),a=Object(o.c)();return Object(n.useEffect)((function(){(function(){var e=Object(p.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(function(){var e=Object(p.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.query();case 2:(a=e.sent)&&t({type:"SET_BOARDS",boards:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:console.log("adsasd");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),c.a.createElement("div",null,c.a.createElement("h1",null,"Boards new"),t&&t.length&&t.map((function(e){return c.a.createElement("div",{key:e._id},c.a.createElement(s.b,{to:"board/".concat(e._id)},e._id))})))};var Fe=function(){return c.a.createElement("main",null,c.a.createElement(s.a,null,c.a.createElement(d,null),c.a.createElement(i.c,null,c.a.createElement(i.a,{path:"/boards",component:_e}),c.a.createElement(i.a,{path:"/board/:boardId",component:ze}),c.a.createElement(i.a,{path:"/",component:u}))))};a(177),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Pe=a(17),Ge=a(103),He={boards:null,currBoard:null,currTask:null,isExpanded:!1},We={isInitialAddition:!1},qe=Object(Pe.e)(Object(Pe.c)({board:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BOARDS":return Object(_.a)(Object(_.a)({},e),{},{boards:JSON.parse(JSON.stringify(t.boards))});case"SET_BOARD":return Object(_.a)(Object(_.a)({},e),{},{currBoard:Object(_.a)({},t.currBoard)});case"SET_TASK":var a;return e.currBoard.taskLists.forEach((function(e){e.tasks.find((function(e){e.id===t.id&&(a=e)}))})),Object(_.a)(Object(_.a)({},e),{},{currTask:a?Object(_.a)({},a):null});case"UPDATE_TASK":return Object(_.a)(Object(_.a)({},e),{},{currTask:Object(_.a)({},t.currTask)});case"TOGGLE_LABELS":return Object(_.a)(Object(_.a)({},e),{},{isExpanded:!e.isExpanded});default:return e}},general:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_INITIAL_ADDITION":return Object(_.a)(Object(_.a)({},e),{},{isInitialAddition:t.isInitial});default:return e}}}),Object(Pe.a)(Ge.a));l.a.render(c.a.createElement(o.a,{store:qe},c.a.createElement(Fe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[105,1,2]]]);
//# sourceMappingURL=main.19db2d63.chunk.js.map