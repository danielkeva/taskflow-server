(this["webpackJsonptreller-react"]=this["webpackJsonptreller-react"]||[]).push([[5],{186:function(e,t,a){"use strict";a.r(t);var n=a(17),c=a(41),r=a.n(c),l=a(42),o=a(40),i=a(0),s=a.n(i),u=a(21),d=a(50),m=a(3),b=a(67),f=a(65),p=a(51),v=a(53),E=a(22),g=a(2);var k=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(i.useEffect)((function(){var n=function(n){e&&e.current&&!e.current.contains(n.target)&&(null===a||a.current&&!a.current.contains(n.target)?t(n):console.log("exceptionalRef",a))};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,a,t])},O=a(45),h=a(44),j=a(63),N=a(9),y=a(93),C=function(e){var t=e.labels,a=e.onLabelClicked,n=void 0===a?null:a,c=e.expandMode,r=Object(u.c)(),l=Object(u.d)((function(e){return e.board.isExpanded})),o=function(e){e.preventDefault(),null!==n?n(e):r(Object(d.f)())};return s.a.createElement("div",{className:"labels-list"},t.map((function(e){return s.a.createElement("span",{onClick:o,key:e.id,className:"label  ".concat(l||c?"label-expand":""),style:{backgroundColor:e.color}},s.a.createElement("span",{className:"label-title"},e.title))})),c&&s.a.createElement("button",{className:"modal-btn",onClick:o},s.a.createElement(y.a,{className:"icon-md"})))},x=a(64),w=a.n(x),I=a(95),S=a(160);function D(){var e=Object(j.a)(["\n    ","\n            font-size:",";\n            font-family:",";\n\n            ","\n    "]);return D=function(){return e},e}var L=I.a.div(D(),(function(e){return e.cover.isFull?"color"===e.cover.type?{backgroundColor:e.cover.isFull?e.cover.background:""}:{backgroundImage:"url("+e.cover.background+")",minHeight:235,backgroundSize:"cover"}:""}),(function(e){return e.cover.isFull?"16px":""}),(function(e){return e.cover.isFull?"LatoBold":""}),(function(e){return e.cover.isFull?{display:"flex",fontSize:"16px",fontFamily:"LatoBold"}:""})),A={lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",sameElse:"MMMM D"},R=function(e){var t=e.card,a=e.index,n=Object(m.h)().url,c=Object(i.useMemo)((function(){return t.checklists.reduce((function(e,t){t.listItems.length>0&&(e+=t.listItems.reduce((function(e,t){return t.isDone&&e++,e}),0));return e}),0)}),[t.checklists]),r=Object(i.useMemo)((function(){return t.checklists.reduce((function(e,t){return t.listItems.length>0&&(e+=t.listItems.length),e}),0)}),[t.checklists]),l=Object(i.useMemo)((function(){if(t.dueDate){var e=new Date;return e.setHours(0,0,0,0),e.setDate(e.getDate()+1),e.getTime()===t.dueDate?"due-soon":t.dueDate<=Date.now()?"over-due":""}}),[t.dueDate]);return s.a.createElement(b.b,{draggableId:t.id,index:a,type:"card"},(function(e){return s.a.createElement("div",Object.assign({className:"card-preview"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),s.a.createElement(N.b,{to:"".concat(n,"/").concat(t.id),className:"card-link",activeClassName:"active",draggable:"false"},s.a.createElement(L,{cover:t.cover},t.cover.background&&!t.cover.isFull&&s.a.createElement("div",null,"color"===t.cover.type?s.a.createElement("div",{className:t.cover.background?"card-cover":"",style:{backgroundColor:t.cover.background}}):s.a.createElement("img",{src:t.cover.background,className:"card-img-cover ratio-square "})),s.a.createElement("div",{className:"card-preview-content \n                                    ".concat("img"===t.cover.type&&t.cover.isFull?"dark"===t.cover.theme?"content-wrapper dark":"content-wrapper light":"")},t.labels&&s.a.createElement(C,{labels:t.labels}),s.a.createElement("div",{className:"card-preview-title",dir:"auto"},t.title),s.a.createElement("div",{className:"badges"},t.dueDate&&s.a.createElement("div",{className:"badge "+l},s.a.createElement(h.e,{className:"icon-sm"}),s.a.createElement(w.a,{className:"badge-text",calendar:A,date:t.dueDate})),t.description&&s.a.createElement("div",{className:"badge"},s.a.createElement(S.a,{className:"icon-md"})),t.checklists.length>0&&r>0&&s.a.createElement("div",{className:"badge checklist-items-badge "+(c===r?"card-complete":"")},s.a.createElement(y.b,{className:"icon-sm"}),s.a.createElement("span",{className:"badge-text"},c,"/",r)))))))}))};var M=function(e){var t=Object(i.useState)(!1),a=Object(o.a)(t,2),n=a[0],c=a[1];function r(t){t.key===e&&c(!0)}var l=function(t){t.key===e&&c(!1)};return Object(i.useEffect)((function(){return window.addEventListener("keydown",r),window.addEventListener("keyup",l),function(){window.removeEventListener("keydown",r),window.removeEventListener("keyup",l)}}),[]),n},T=function(e){var t=e.type,a=e.text,n=e.name,c=e.onInputBlur,r=e.isWide,l=e.isFocused,u=e.onChange,d=e.onSubmit,m=e.onEscape,b=e.placeholder,f=void 0===b?null:b,p=Object(i.useState)(!1),v=Object(o.a)(p,2),E=v[0],g=v[1],k=Object(i.useState)(""),O=Object(o.a)(k,2),h=O[0],j=O[1],N=Object(i.useRef)(null),y=M("Enter"),C=M("Escape");Object(i.useEffect)((function(){E&&N.current.focus()}),[E]),Object(i.useEffect)((function(){l&&g(!0),!1===l&&g(!1)}),[l,E]),Object(i.useEffect)((function(){E&&j(a)}),[E]),Object(i.useEffect)((function(){E&&!r&&(y&&(c?c():d(),g(!1)),C&&(u({target:{name:n,value:h}}),g(!1),m&&m()))}),[y,C]);var x=s.a.createElement(t,{className:"module-text  ".concat(a?"":"placeholder"),dir:"auto",onClick:function(){g(!0)}},a||f),w=function(){c&&(console.log("blur"),g(!1),c())};return s.a.createElement("div",{className:"text-editor-wrapper"},E?r?s.a.createElement("textarea",{ref:N,className:"focusClass",autoFocus:!0,rows:"5",name:n,defaultValue:a,onChange:function(e){u(e)},onBlur:w,placeholder:f}):s.a.createElement("input",{dir:"auto",type:"text",ref:N,autoFocus:!0,className:"focusClass",name:n,defaultValue:a,onChange:function(e){var t=e.target.value;/^\s+$/.test(t)||""===t||u(e)},onBlur:w}):x)},B=function(e){var t=e.onCloseMenu,a=e.onRemoveList,n=e.onAddCard;return s.a.createElement("div",{className:"pop-up list-menu"},s.a.createElement("div",{className:"pop-up-header"},s.a.createElement("span",{className:"pop-up-title"},"Labels"),s.a.createElement("button",{className:"pop-up-close-btn clear-btn",onClick:function(){return t()}},s.a.createElement(h.d,null))),s.a.createElement("div",{onClick:n},"Add card"),s.a.createElement("div",null,"Change list color"),s.a.createElement("div",null,"Sort list by"),s.a.createElement("div",{onClick:a},"Delete list"))},U=function(e){var t=e.provided,a=e.innerRef,n=e.cardList,c=e.cardListIdx,u=e.onListUpdated,d=e.onRemoveList,p=Object(i.useState)(Object(g.a)({},n)),v=Object(o.a)(p,2),j=v[0],N=v[1],y=Object(i.useState)(null),C=Object(o.a)(y,2),x=C[0],w=C[1],I=Object(i.useState)(!1),S=Object(o.a)(I,2),D=S[0],L=S[1],A=Object(m.h)().url,M=Object(i.useState)(!1),U=Object(o.a)(M,2),z=U[0],J=U[1],F=Object(i.useRef)(null);Object(i.useEffect)((function(){N(Object(g.a)({},n))}),[n]);var P=function(){J(!1);var e=O.a.getEmptyCard();w(e),L(!0)},_=function(e){w(Object(g.a)(Object(g.a)({},x),{},Object(E.a)({},e.target.name,e.target.value)))},q=function(e,t){if(e)u(e,t);else{if(j.title===n.title)return;u(j)}L(!1),w(null)},G=function(){var e=Object(l.a)(r.a.mark((function e(){var t,a,n,c=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:null,!x||!x.title){e.next=11;break}return(a=JSON.parse(JSON.stringify(j))).cards.push(x),n=O.a.newActivity("Added this card to ".concat(a.title),"Added  [".concat(x.title,"](").concat(A,"/").concat(x.id,") to ").concat(a.title),x.id),e.next=7,q(a,n);case 7:if("clickedOutside"!==t){e.next=9;break}return e.abrupt("return");case 9:w(null),P();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();k(F,(function(){D&&x&&x.title?G("clickedOutside"):H()}));var H=function(){w(null),L(!1)};return j&&s.a.createElement("div",Object.assign({className:"list-wrapper",ref:a},t.draggableProps),s.a.createElement("div",{className:"list"},s.a.createElement("div",Object.assign({className:"list-header"},t.dragHandleProps),j.title&&s.a.createElement(T,{name:"title",type:"h3",text:j.title,onChange:function(e){N(Object(g.a)(Object(g.a)({},j),{},Object(E.a)({},e.target.name,e.target.value)))},onInputBlur:q}),s.a.createElement("button",{className:"list-menu-btn clear-btn",onClick:function(){return J(!z)}},s.a.createElement(f.a,null)),z&&!D&&s.a.createElement(B,{onRemoveList:function(){d(n.id)},onAddCard:P,onCloseMenu:function(){return J(!1)}})),s.a.createElement("div",{className:"overs"},s.a.createElement(b.c,{type:"card",droppableId:"".concat(c)},(function(e){return s.a.createElement("div",{className:"list-content custom-scrollbar",ref:e.innerRef},n.cards.map((function(e,t){return s.a.createElement(R,{key:e.id,card:e,index:t})})),D&&x&&s.a.createElement("div",{className:"add-card-wrapper ",ref:F},s.a.createElement(T,{name:"title",type:"p",text:x.title,onChange:_,isFocused:D,onSubmit:G,onEscape:H}),s.a.createElement("div",{className:"add-card-controls"},s.a.createElement("button",{onClick:G,className:"submit-btn"},"Add card"),s.a.createElement("button",{onClick:H,className:"clear-btn icon-lg"},s.a.createElement(h.d,null)))),e.placeholder)}))),s.a.createElement("div",{className:"list-footer"},!D&&!x&&s.a.createElement("a",{className:"clear-btn list-footer-btn",onClick:P},s.a.createElement("span",{className:"icon-lg add-icon"},s.a.createElement(h.a,null))," ",s.a.createElement("span",null,"Add new card")))))};function z(e){return function(){var t=Object(l.a)(r.a.mark((function t(a,n){var c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=n().activity.boardId,t.prev=1,t.next=4,O.a.addActivity(c,e);case 4:a({type:"ADD_ACTIVITY",activity:e}),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(1),t.t0;case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,a){return t.apply(this,arguments)}}()}var J=a(161),F=a.n(J),P=a(169),_=function(e){var t=e.card,a=e.labels,c=e.onCloseModal,r=e.onCardUpdated,l=e.labelsUpdated,u=e.bounds,d=e.exceptionRef,m=Object(i.useState)(null),b=Object(o.a)(m,2),f=b[0],p=b[1],v=Object(i.useState)(!1),O=Object(o.a)(v,2),j=O[0],N=O[1],y=Object(i.useRef)(null);k(y,(function(){c()}),d);var C=function(e){p(Object(g.a)(Object(g.a)({},f),{},Object(E.a)({},e.target.name,e.target.value)))},x=function(){var e=Object(n.a)(a),t=e.findIndex((function(e){return e.id===f.id}));e.splice(t,1,f),l(Object(n.a)(e),f),N(!1),p(null)};Object(i.useEffect)((function(){if(!j&&f){var e=JSON.parse(JSON.stringify(t)),a=e.labels.findIndex((function(e){return e.id===f.id}));-1!==a&&(e.labels.splice(a,1,f),r(e))}}),[j]);var w=function(e){if(f)return e.id===f.id};return s.a.createElement("div",{className:"pop-up labels",ref:y,style:u},s.a.createElement("div",{className:"pop-up-header"},s.a.createElement("span",{className:"pop-up-title"},"Labels"),s.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:c},s.a.createElement(h.d,null))),s.a.createElement("ul",null,a.map((function(e){return s.a.createElement("li",{className:"label-container",key:e.id},s.a.createElement("span",{className:"card-label",style:{backgroundColor:e.color},onClick:function(){return function(e){var a=JSON.parse(JSON.stringify(t));if(a.labels.find((function(t){return t.id===e.id}))){var n=a.labels.findIndex((function(t){return t.id===e.id}));a.labels.splice(n,1)}else a.labels.push(e);r(a)}(e)}},!w(e)&&s.a.createElement("span",{className:"label-title"},e.title),w(e)&&j&&s.a.createElement(T,{type:"p",name:"title",isFocused:j,text:e.title,onChange:C,onInputBlur:x}),s.a.createElement("span",{className:"label-selected"})),s.a.createElement("button",{className:"clear-btn",onClick:function(){return function(e){null!==f&&f.id===e.id?N(!1):(p(Object(g.a)({},e)),N(!0))}(e)}},s.a.createElement(P.a,null)))}))))},q=a(94),G=a.n(q),H=a(184),W=(a(170),function(e){var t=e.card,a=e.onCardUpdated,n=e.onCloseModal,c=e.bounds,u=e.exceptionRef,d=Object(i.useState)(new Date),b=Object(o.a)(d,2),f=b[0],p=b[1],v=Object(m.h)().url,E=Object(i.useRef)(null);Object(i.useEffect)((function(){if(t.dueDate){var e=new Date(t.dueDate);p(e)}}),[]),k(E,(function(){n()}),u);var g=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=G()(new Date(e)).format("MMM Do");return t.dueDate?O.a.newActivity("Changed the due date of this card to  ".concat(n),"Changed [".concat(t.title,"](").concat(v,") to be due at ").concat(n),t.id):a?O.a.newActivity("Removed the due date from this card","Removed [".concat(t.title,"](").concat(v,") due date"),t.id):O.a.newActivity("Set this card to be due at ".concat(n),"Set [".concat(t.title,"](").concat(v,") to be due at ").concat(n," "),t.id)},j=function(){var e=Object(l.a)(r.a.mark((function e(){var c,l,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=f.getTime())!==t.dueDate){e.next=3;break}return e.abrupt("return");case 3:return(l=JSON.parse(JSON.stringify(t))).dueDate=c,o=g(c),e.next=8,a(l,o);case 8:n();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return s.a.createElement("div",{className:"pop-up",style:c,ref:E},s.a.createElement("div",{className:"pop-up-header"},s.a.createElement("span",{className:"pop-up-title"},"Date"),s.a.createElement("button",{onClick:n,className:"pop-up-close-btn clear-btn icon-lg"},s.a.createElement(h.d,null))),s.a.createElement(H.a,{onChange:function(e){p(e)},value:f}),s.a.createElement("button",{onClick:j,className:"submit-btn add-date-btn"},"Save"))});function V(e){return function(t){t({type:"TOGGLE_INITIAL_ADDITION",isInitial:e})}}var Y=function(e){var t=e.card,a=e.onCardUpdated,n=e.onCloseModal,c=e.bounds,r=e.sidebarRef,l=Object(i.useState)({}),d=Object(o.a)(l,2),b=d[0],f=d[1],p=Object(i.useRef)(null),v=Object(m.h)().url,h=Object(u.c)();Object(i.useEffect)((function(){var e=O.a.getEmptyCheckList();f(Object(g.a)({},e))}),[]),k(p,(function(){n()}),r);var j=function(){var e=JSON.parse(JSON.stringify(t)),c=Object(g.a)({},b);e.checklists.push(c);var r=O.a.newActivity("Added ".concat(b.title,"  on this card"),"Added ".concat(b.title," on [").concat(t.title,"](").concat(v,")"),t.id);a(e,r),h(V(!0)),n()};return s.a.createElement("div",{className:"pop-up",style:c,ref:p},s.a.createElement("div",{className:"pop-up-header"},s.a.createElement("span",{className:"pop-up-title"},"Add checklist"),s.a.createElement("button",{className:"pop-up-close-btn clear-btn"})),s.a.createElement(T,{isFocused:!0,onChange:function(e){f(Object(g.a)(Object(g.a)({},b),{},Object(E.a)({},e.target.name,e.target.value)))},onSubmit:j,type:"p",name:"title"}),s.a.createElement("button",{onClick:j,className:"submit-btn add-date-btn"},"Save"))},X={uploadImg:function(e){console.log("yes");var t="https://api.cloudinary.com/v1_1/".concat("dhz1jk4k6","/image/upload"),a=new FormData;return a.append("file",e.target.files[0]),a.append("upload_preset","jtim2mm3"),fetch(t,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.error(e)}))}};var K=a(172),Q=a.n(K);function Z(){var e=Object(j.a)(["\n","\n"]);return Z=function(){return e},e}function $(){var e=Object(j.a)(["\n","\n"]);return $=function(){return e},e}var ee=I.a.div($(),(function(e){return"color"===e.cover.type?{backgroundColor:e.cover.background}:{backgroundImage:"url("+e.cover.background+")",backgroundSize:"cover"}})),te=I.a.div(Z(),(function(e){return"color"===e.cover.type?{backgroundColor:e.cover.background}:{backgroundImage:"light"===e.cover.theme?"linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),url("+e.cover.background+")":"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),url("+e.cover.background+")",backgroundSize:"cover",backgroundPosition:"50%"}})),ae=function(e){var t=e.card,a=e.onCloseModal,n=e.onCardUpdated,c=e.bounds,u=e.exceptionRef,d=Object(i.useState)(t.cover),m=Object(o.a)(d,2),b=m[0],f=m[1],v=Object(i.useState)(!1),E=Object(o.a)(v,2),O=E[0],j=E[1],N=Object(i.useRef)(null);k(N,(function(){a()}),u);var y=function(e){var a=Object(g.a)({},t);e.id?(f(Object(g.a)(Object(g.a)({},b),{},{background:e.url,type:"img"})),a.cover.type="img",a.cover.background=e.url):(f(Object(g.a)(Object(g.a)({},b),{},{background:e,type:"color"})),a.cover.type="color",a.cover.background=e),n(a)},C=function(e){if(t.cover.background){f(Object(g.a)(Object(g.a)({},b),{},{isFull:e}));var a=Object(g.a)({},t);a.cover.isFull=e,n(a)}},x=function(e){if(e!==b.theme){f(Object(g.a)(Object(g.a)({},b),{},{theme:e}));var a=Object(g.a)({},t);a.cover.theme=e,n(a)}},w=function(){var e=Object(l.a)(r.a.mark((function e(a){var c,l,o,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("yes mame"),j(!0),e.next=4,X.uploadImg(a);case 4:c=e.sent,l=c.url,f(Object(g.a)(Object(g.a)({},b),{},{background:l,type:"img"})),o=Object(g.a)({},t),i={id:p.a.makeId(),url:l,isCover:!0},o.images.push(i),o.cover.background=l,o.cover.type="img",n(o),j(!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s.a.createElement("div",{className:"pop-up cover-picker ".concat(c?"":"absolute"),ref:N,style:c},s.a.createElement("div",{className:"pop-up-header"},s.a.createElement("span",{className:"pop-up-title"},"Cover"),s.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:a},s.a.createElement(h.d,null))),s.a.createElement("span",{className:"pop-up-title"},"Size"),s.a.createElement("div",{className:"cover-size-picker"},s.a.createElement(te,{cover:b,className:"cover-size "+(t.cover.background?b.isFull?"selected":"":"disabled"),onClick:function(){return C(!0)}},s.a.createElement("div",{className:"line-wrapper ".concat("img"===t.cover.type&&"dark"===t.cover.theme?"dark":"")},s.a.createElement("div",{className:"line line1"}),s.a.createElement("div",{className:"line line2"}),s.a.createElement("div",{className:"line line3"}))),s.a.createElement("div",{className:"cover-size half "+(t.cover.background?b.isFull?"":"selected":"disabled"),onClick:function(){return C(!1)}},s.a.createElement(ee,{className:"half",cover:b}),s.a.createElement("div",{className:"line-wrapper"},s.a.createElement("div",{className:"line line1"}),s.a.createElement("div",{className:"line line2"}),s.a.createElement("div",{className:"line line3"})))),t.cover.background&&s.a.createElement("button",{className:"modal-btn",onClick:function(){f(Object(g.a)(Object(g.a)({},b),{},{background:null,type:null,isFull:null,theme:null}));var e=Object(g.a)({},t);e.cover=Object(g.a)(Object(g.a)({},e.cover),{},{background:null,type:null,isFull:null,theme:null}),n(e),a()}},"Remove Cover"),"img"===b.type&&b.isFull&&s.a.createElement("div",{className:"cover-txt-color"},s.a.createElement("span",{className:"pop-up-title"},"Text color"),s.a.createElement("div",{className:"flex justify-center"},s.a.createElement("div",{onClick:function(){return x("light")},className:"cover-txt light",style:{backgroundImage:"linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),url(".concat(b.background,")")}},s.a.createElement("h3",null,t.title)),s.a.createElement("div",{onClick:function(){return x("dark")},className:"cover-txt dark",style:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),url(".concat(b.background,")")}},s.a.createElement("h3",null,t.title)))),s.a.createElement("span",{className:"pop-up-title"},"Colors"),s.a.createElement("div",{className:"cover-palette"},["#61bd4f","#f2d600","#ff9f1a","#c377e0","#eb5a46","#055a8c","#705cc1","#00c2e0","#ff78cb"].map((function(e,t){return s.a.createElement("span",{className:"cover-color "+(e===b.background?"selected":""),style:{backgroundColor:e},key:t,onClick:function(){return y(e)}})}))),t.images.length>0&&s.a.createElement("span",{className:"pop-up-title"},"Images"),t.images.length>0&&s.a.createElement("div",{className:"cover-img-wrapper"},t.images.map((function(e){return s.a.createElement("span",{className:"cover-img-preview "+(e.url+e.id===b.background+e.id?"selected":""),style:{backgroundImage:"url(".concat(e.url,")")},onClick:function(){return y(e)},key:e.id})}))),s.a.createElement("div",{className:"upload-img-container flex space-between align-center"},s.a.createElement("p",null,"Upload image:"),s.a.createElement("input",{onChange:w,id:"file",type:"file",title:"Upload Image"}),s.a.createElement("label",{className:"btn-3",htmlFor:"file"},O?s.a.createElement(Q.a,{height:9,width:5,color:"#2c3e50",loading:O}):s.a.createElement("span",null,"Upload"))),s.a.createElement("hr",{className:"divider"}))},ne=function(e){var t=e.card,a=e.labels,n=e.onUpdateCard,c=e.onLabelsUpdated,r=e.onAddActivity,l=Object(i.useRef)(null),u=Object(i.useState)(null),d=Object(o.a)(u,2),m=d[0],b=d[1],f=Object(i.useState)(null),p=Object(o.a)(f,2),v=p[0],E=p[1],g=Object(i.useRef)(null),k=function(e,t){g.current=e.target.id;var a=e.target.getBoundingClientRect(),n=a.top,c=a.left,r=a.height;window.innerWidth-c-304<50&&window.innerWidth>770?E({top:n+r,left:c-100}):E({top:n+r,left:c-50}),t===m?(b(null),E(null),g.current=null):b(t)},O=Object(i.useCallback)((function(){if(g.current){var e=document.getElementById(g.current).getBoundingClientRect(),t=e.top,a=e.left,n=e.height,c=window.innerWidth-a-304;E(c<50?{top:t+n,right:0}:{top:t+n,left:a})}}),[]);Object(i.useEffect)((function(){m?window.addEventListener("resize",O):window.removeEventListener("resize",O)}),[m]);var h=function(){b(null),g.current=null};return s.a.createElement("div",{className:"modal-sidebar",ref:l},s.a.createElement("h3",null,"Add to card"),s.a.createElement("button",{id:"sidebar-labels",className:"modal-btn",onClick:function(e){return k(e,"isLabelActive")}},"Labels"),"isLabelActive"===m&&s.a.createElement(_,{bounds:v,card:t,labels:a,onCloseModal:h,onCardUpdated:n,labelsUpdated:c,exceptionRef:l}),s.a.createElement("button",{className:"modal-btn"},"Members"),s.a.createElement("button",{id:"sidebar-checklist",className:"modal-btn",onClick:function(e){return k(e,"isChecklistActive")}},"Checklist"),"isChecklistActive"===m&&s.a.createElement(Y,{card:t,bounds:v,onCardUpdated:n,onCloseModal:h,exceptionRef:l}),s.a.createElement("button",{id:"sidebar-date",className:"modal-btn",onClick:function(e){return k(e,"isDueDateActive")}},"Due date"),"isDueDateActive"===m&&s.a.createElement(W,{bounds:v,card:t,onCardUpdated:n,onAddActivity:r,onCloseModal:h,exceptionRef:l}),!t.cover.background&&s.a.createElement("button",{id:"sidebar-cover",className:"modal-btn",onClick:function(e){return k(e,"isCoverActive")}},"Cover"),"isCoverActive"===m&&s.a.createElement(ae,{bounds:v,exceptionRef:l,card:t,onCloseModal:h,onCardUpdated:n}))},ce=a(177);var re=Object(i.memo)((function(e){var t=e.card,a=e.item,n=e.onSubmit,c=e.onRemoveItem,r=Object(i.useState)(Object(g.a)({},a)),l=Object(o.a)(r,2),u=l[0],d=l[1],b=Object(i.useState)(!1),p=Object(o.a)(b,2),v=p[0],j=p[1],N=Object(i.useState)(!1),y=Object(o.a)(N,2),C=y[0],x=y[1],w=Object(i.useState)(""),I=Object(o.a)(w,2),S=I[0],D=I[1],L=Object(i.useRef)(null),A=Object(i.useRef)(!0),R=Object(m.h)().url;k(L,(function(){v&&(a.title!==u.title&&(D(u.title),d((function(e){return Object(g.a)(Object(g.a)({},e),{},{title:a.title})})),x(!0)),j(!1))})),Object(i.useEffect)((function(){if(A.current)A.current=!1;else{var e=O.a.newActivity("".concat(u.isDone?"Completed  ".concat(a.title," on this card"):"Marked ".concat(a.title," incomplete on this card")),"".concat(u.isDone?"Completed  ".concat(a.title," on [").concat(t.title,"](").concat(R,")"):"Marked ".concat(a.title," incomplete on [").concat(t.title,"](").concat(R,")")),t.id);U(e)}}),[u.isDone]);var M=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;d(Object(g.a)(Object(g.a)({},u),{},Object(E.a)({},n,a)))},B=function(){j(!1)},U=function(e){u.title?(j(!1),x(!1),n(Object(g.a)({},u),e)):j(!0)};return s.a.createElement("div",{className:"checklist-item"},s.a.createElement("div",{className:"checklist-item-editor  "+(a.isDone?"done":"")},u&&!v&&s.a.createElement("input",{type:"checkbox",name:"isDone",checked:u.isDone,onChange:M}),s.a.createElement("div",{className:"item-title",onClick:function(){return j(!0)},ref:L},s.a.createElement(T,{text:a.title,onChange:M,onSubmit:U,onEscape:B,isFocused:v,type:"p",name:"title"}),v&&s.a.createElement("div",{className:"add-item-controls"},s.a.createElement("button",{className:"submit-btn"},"Save"),s.a.createElement("button",{className:"clear-btn icon-lg",onClick:B},s.a.createElement(h.d,null)),s.a.createElement("div",{className:"spacer",onClick:B}))),!v&&s.a.createElement("button",{className:"remove-item-btn clear-btn",onClick:function(){c(u.id)}},s.a.createElement(f.b,null))),C&&!v&&s.a.createElement("p",{className:"checklist-user-msg"},s.a.createElement("span",null,"You have unsaved edits on this field."),s.a.createElement("button",{className:"clear-btn",onClick:function(){d((function(e){return Object(g.a)(Object(g.a)({},e),{},{title:S})})),j(!0)}},"View edits"),s.a.createElement("button",{className:"clear-btn",onClick:function(){x(!1)}},"Discard")))}),(function(e,t){return ce(e.item,t.item)})),le=a(178),oe=(a(179),function(e){var t=e.card,a=e.checklist,n=e.onUpdateCard,c=Object(i.useState)(null),d=Object(o.a)(c,2),b=d[0],f=d[1],p=Object(i.useState)(a.title),v=Object(o.a)(p,2),j=v[0],N=v[1],y=Object(i.useState)(null),C=Object(o.a)(y,2),x=C[0],w=C[1],I=Object(i.useState)(!1),S=Object(o.a)(I,2),D=S[0],L=S[1],A=Object(i.useRef)(null),R=Object(m.h)().url,M=Object(u.c)(),B=Object(u.d)((function(e){return e.general.isInitialAddition}));Object(i.useEffect)((function(){B&&U()}),[]),Object(i.useMemo)((function(){var e=a.listItems.reduce((function(e,t){return t.isDone&&e++,e}),0),t=Math.round(100*e/a.listItems.length);w(t)}),[a]);var U=function(){var e=O.a.getEmptyListItem();f(e),L(!0),B&&M(V(!1))},z=function(){L(!1),f(null)};k(A,(function(){D&&(L(!1),f(null))}));var J=function(e){var t=Object(g.a)({},a),n=t.listItems.findIndex((function(t){return t.id===e}));-1!==n&&t.listItems.splice(n,1),P(t)},F=function(){var e=Object(l.a)(r.a.mark((function e(t,n){var c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Object(g.a)({},a),!t){e.next=9;break}if(-1===(l=c.listItems.findIndex((function(e){return e.id===t.id})))){e.next=7;break}return c.listItems.splice(l,1,t),e.next=7,P(c,n);case 7:e.next=16;break;case 9:if(b.title){e.next=12;break}return z(),e.abrupt("return");case 12:return c.listItems.push(b),e.next=15,P(c);case 15:U();case 16:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),P=function(e,c){var r=JSON.parse(JSON.stringify(t));if(e){var l=r.checklists.findIndex((function(t){return t.id===e.id}));r.checklists.splice(l,1,e)}else r.checklists=r.checklists.filter((function(e){return e.id!==a.id})),c=O.a.newActivity("Removed ".concat(a.title,"  on this card"),"Removed ".concat(a.title," on [").concat(t.title,"](").concat(R,")"),t.id);n(r,c),L(!1),f(null)};return s.a.createElement("div",{className:"card-checklist"},s.a.createElement("div",{className:"section-title flex align-center"},s.a.createElement(T,{text:j,onChange:function(e){N(e.target.value)},onInputBlur:function(){var e=Object(g.a)({},a);e.title=j;var n=O.a.newActivity("Renamed ".concat(e.title," from (").concat(a.title,")"),"Renamed ".concat(e.title," from (").concat(a.title,') on <a href="').concat(R,'">').concat(t.title,"</a>"),t.id);P(e,n)},type:"h3"}),s.a.createElement("button",{className:"modal-btn",onClick:function(){return P()}},"Delete")),a.listItems.length>0&&s.a.createElement(le.Progress,{percent:x}),a&&a.listItems.map((function(e){return s.a.createElement(re,{key:e.id,onSubmit:F,onRemoveItem:J,item:e,card:t})})),b&&D&&s.a.createElement("div",{className:"add-item",ref:A},s.a.createElement(T,{onChange:function(e){f(Object(g.a)(Object(g.a)({},b),{},Object(E.a)({},e.target.name,e.target.value)))},onSubmit:F,onEscape:z,isFocused:D,type:"p",name:"title"}),s.a.createElement("div",{className:"add-item-controls"},s.a.createElement("button",{className:"submit-btn",onClick:function(){return F()}},"Save"),s.a.createElement("button",{className:"clear-btn icon-lg",onClick:z},s.a.createElement(h.d,null)),s.a.createElement("div",{className:"spacer",onClick:z}))),!D&&s.a.createElement("button",{className:"modal-btn",onClick:U},"Add an item"))}),ie=a(180),se=a(181),ue={lastDay:"[Yesterday at] LT",sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",lastWeek:"[last] dddd [at] LT",nextWeek:"dddd [at] LT",sameElse:"MMMM D [at] LT"},de=function(){return Object(ie.a)((function(e){return e.activity.activities}),(function(e,t){return t}),(function(e,t){return t?e.filter((function(e){return e.cardId===t})):e}))},me=Object(i.memo)((function(e){var t=e.cardId,a=void 0===t?null:t,n=Object(i.useMemo)(de,[]),c=Object(u.d)((function(e){return n(e,a)})),r=Object(i.useState)(!0),l=Object(o.a)(r,2),d=l[0],b=l[1],f=Object(i.useState)(!0),p=Object(o.a)(f,2),v=p[0],E=p[1],g=Object(i.useState)([]),k=Object(o.a)(g,2),O=k[0],h=k[1],j=Object(i.useState)(5),N=Object(o.a)(j,2),y=N[0],C=N[1],x=Object(m.f)();Object(i.useEffect)((function(){c.length>0&&(h(c.slice(0,5)),E(!0),C(5))}),[c.length]);Object(i.useEffect)((function(){if(!a){var e=document.getElementById("boardActivity");if(e&&e.childNodes[1])return e.childNodes[1].addEventListener("click",I),function(){e.childNodes[1].removeEventListener("click",I)}}}),[O]);var I=function(e){e.preventDefault(),e.stopPropagation();var t=e.target.getAttribute("href");x.push(t)};return s.a.createElement("div",{className:"activity-log"},a&&s.a.createElement("button",{className:"modal-btn",onClick:function(){b((function(e){return!e}))}},d?"Hide details":"Show details"),d&&O.length>0&&O.map((function(e){return s.a.createElement("div",{className:"activity-content",key:e.id},a?s.a.createElement("p",{className:"activity-desc"},e.cardTxt):s.a.createElement(se.a,{className:"activity-desc",id:"boardActivity",options:{forceBlock:!0}},e.boardTxt),s.a.createElement(w.a,{calendar:ue},e.date))})),d&&v&&c.length>5&&s.a.createElement("button",{className:"clear-btn show-more-btn",onClick:function(){var e=y+5,t=e<=c.length-1,a=O.concat(c.slice(y,e));C(e),h(a),E(t)}}," Load More "))})),be={lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",sameElse:"MMMM D"},fe=function(){var e=Object(u.c)(),t=Object(u.d)((function(e){return e.board.currCard})),a=Object(u.d)((function(e){return e.board.currBoard})),n=Object(i.useState)(null),c=Object(o.a)(n,2),b=c[0],f=c[1],p=Object(i.useState)(null),v=Object(o.a)(p,2),j=v[0],N=v[1],y=Object(i.useRef)(null),x=Object(i.useRef)(null),I=Object(i.useRef)(null),S=Object(m.g)().cardId,D=Object(m.f)(),L=Object(m.h)().url;Object(i.useEffect)((function(){(function(){var t=Object(l.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(Object(d.c)(S));case 2:t.sent||D.push("/board/".concat(a._id));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(i.useEffect)((function(){return document.body.style.overflowX="hidden",function(){document.body.style.overflowX="unset"}}),[]),Object(i.useEffect)((function(){t&&N(Object(g.a)({},t))}),[t]);var A=function(){D.push("/board/".concat(a._id))};k(y,(function(){A()})),k(x,(function(){f(null)}));var R=function(e){N(Object(g.a)(Object(g.a)({},j),{},Object(E.a)({},e.target.name,e.target.value)))},M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?B(Object(g.a)({},e),t):B(Object(g.a)({},j))},B=Object(i.useCallback)((function(t,n){e(Object(d.g)(t));var c=JSON.parse(JSON.stringify(a));c.cardLists.forEach((function(e){var a=e.cards.findIndex((function(e){return e.id===t.id}));-1!==a&&e.cards.splice(a,1,t)})),e(Object(d.d)(c)),n&&e(z(n))}),[e]),U=function(t,n){var c=JSON.parse(JSON.stringify(a));c.labels=t,c.cardLists.forEach((function(e){e.cards.forEach((function(e){var t=e.labels.find((function(e){return e.id===n.id}));t&&(t.title=n.title)}))})),e(Object(d.d)(c))},J=function(e,t){var a=e.target;I.current=a,f(t!==b?t:null)},P=Object(i.useMemo)((function(){if(t){var e=new Date;return e.setHours(0,0,0,0),e.setDate(e.getDate()+1),t.isDone?{class:"card-complete",txt:"Complete"}:e.getTime()===t.dueDate?{class:"due-soon",txt:"Due soon"}:t.dueDate<=Date.now()?{class:"over-due",txt:"Over due"}:""}}),[t]);return s.a.createElement("div",{className:"card-details"},s.a.createElement("div",{className:"cover"}),t&&s.a.createElement("div",{className:"card-modal",ref:y},t.cover.background&&s.a.createElement(F.a,{src:t.cover.background,crossOrigin:"anonymous",format:"hex"},(function(e){var a=e.data;return s.a.createElement("div",{className:"modal-header ",style:{backgroundImage:"url(".concat(t.cover.background,")"),backgroundColor:a||t.cover.background}},t.cover.background&&s.a.createElement("button",{className:"modal-btn",onClick:function(e){return J(e,"coverPicker")}},"Cover"),"coverPicker"===b&&s.a.createElement(ae,{card:t,onCardUpdated:M,onCloseModal:function(){return J("coverPicker")},wrapperRef:x,exceptionRef:I}))})),s.a.createElement("a",{onClick:A,className:"modal-close-btn icon-lg"},s.a.createElement(h.d,null)),s.a.createElement("div",{className:"modal-module"},s.a.createElement("div",{className:"card-title"},s.a.createElement(T,{type:"h3",name:"title",text:t.title,onChange:R,onInputBlur:M}))),s.a.createElement("div",{className:"card-content"},s.a.createElement("div",{className:"left-side"},s.a.createElement("div",{className:"modal-module"},s.a.createElement("div",{className:"card-labels-date"},t.labels.length>0&&s.a.createElement("div",{className:"card-labels"},s.a.createElement("h3",{className:"card-item-title"},"Labels"),s.a.createElement("div",{className:"card-labels-list"},s.a.createElement(C,{expandMode:!0,onLabelClicked:function(e){return J(e,"labelPicker")},labels:t.labels})),"labelPicker"===b&&s.a.createElement(_,{card:t,onCardUpdated:M,labelsUpdated:U,onCloseModal:function(){return J("labelPicker")},labels:a.labels,exceptionRef:I})),t.dueDate&&s.a.createElement("div",{className:"card-due-date"},s.a.createElement("h3",{className:"card-item-title"},"Due date"),s.a.createElement("div",{className:"modal-btn",onClick:function(e){return J(e,"datePicker")}},s.a.createElement("label",null,s.a.createElement("input",{className:"css-checkbox",type:"checkbox",name:"isDone",checked:t.isDone,onChange:function(e){e.stopPropagation(),e.preventDefault();var t=e.target.checked,a=Object(g.a)({},j);a.isDone=t;var n=O.a.newActivity("Marked the due date ".concat(a.isDone?"complete":"incomplete"),"Marked the due date ".concat(a.isDone?"complete":"incomplete"," on [").concat(a.title,"](").concat(L,")"),a.id);B(a,n)}}),s.a.createElement("i",null)),s.a.createElement(w.a,{calendar:be,date:t.dueDate}),s.a.createElement("span",{className:"card-badge "+(P?P.class:"")},P.txt),s.a.createElement(h.b,{className:"icon-lg"})),"datePicker"===b&&s.a.createElement(W,{card:t,onCardUpdated:M,exceptionRef:I,onCloseModal:function(){return J("datePicker")}})))),s.a.createElement("div",{className:"modal-module"},s.a.createElement("div",{className:"card-description"},s.a.createElement("h3",{className:"section-title"},"Description"),s.a.createElement(T,{type:"p",name:"description",text:t.description,onChange:R,onInputBlur:M,isWide:!0,placeholder:"Add a more detailed description\u2026"}))),t.checklists.length>0&&s.a.createElement("div",{className:"modal-module"},t.checklists.map((function(e){return s.a.createElement(oe,{checklist:e,key:e.id,card:t,onUpdateCard:M})}))),s.a.createElement("div",{className:"modal-module"},s.a.createElement("h3",{className:"section-title"},"Activity"),s.a.createElement(me,{cardId:t.id}))),s.a.createElement("div",{className:"right-side"},a&&s.a.createElement(ne,{card:t,labels:a.labels,onUpdateCard:M,onLabelsUpdated:U})))))},pe=function(e){var t=e.board,a=e.onBoardUpdated,n=Object(i.useState)(null),c=Object(o.a)(n,2),r=c[0],l=c[1],u=Object(i.useRef)(null),d=function(){if(r.title){var e=JSON.parse(JSON.stringify(t));e.cardLists.push(r),a(e),l(null)}};return k(u,(function(){l(null)})),s.a.createElement("div",{className:"list-wrapper "},r?s.a.createElement("div",{className:"list add-list",ref:u},s.a.createElement(T,{isFocused:!0,onChange:function(e){l(Object(g.a)(Object(g.a)({},r),{},Object(E.a)({},e.target.name,e.target.value)))},onSubmit:d,name:"title",type:"p"}),s.a.createElement("div",{className:"add-list-controls"},s.a.createElement("button",{className:"submit-btn",onClick:d},"Add List"),s.a.createElement("button",{onClick:function(){return l(null)},className:"clear-btn icon-lg"},s.a.createElement(h.d,null)))):s.a.createElement("button",{className:"modal-btn",onClick:function(){var e=O.a.getEmptyList();l(e)}},"Add another list "))},ve=a(183),Ee=a(182),ge=a.n(Ee),ke=a(66);function Oe(){var e=Object(j.a)(["\n  position: fixed;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n"]);return Oe=function(){return e},e}var he=Object(ke.css)(Oe()),je=function(e){var t=e.onGoBack,a=e.board,n=e.onBoardUpdated,c=Object(i.useState)(null),r=Object(o.a)(c,2),l=r[0],u=r[1],d=Object(i.useState)(!1),m=Object(o.a)(d,2),b=m[0],f=(m[1],function(e,t){if(e!==a.style.background){var c=JSON.parse(JSON.stringify(a));c.style={background:e,type:t},n(c)}});return s.a.createElement("div",{className:"board-menu-bg-picker"},console.log("rednered"),s.a.createElement("button",{className:"pop-up-back-btn clear-btn icon-lg",onClick:function(){l?u(null):t()}},s.a.createElement(h.c,null)),!l&&s.a.createElement("div",{className:"bg-picker-controls"},s.a.createElement("div",{className:"bg-picker-btn",onClick:function(){return u("photos")}},s.a.createElement("span",{className:"photos image"}),s.a.createElement("span",{className:"bg-btn-title"},"Photos")),s.a.createElement("div",{className:"bg-picker-btn",onClick:function(){return u("colors")}},s.a.createElement("span",{className:"colors image"}),s.a.createElement("span",{className:"bg-btn-title"},"Colors"))),s.a.createElement(ge.a,{css:he,size:15,color:"#2c3e50",loading:b}),"photos"===l&&s.a.createElement("div",{className:"bg-section-wrapper"},["https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389449/Taskflow%20backgrounds/cacjncpn6qp4qivznyaj.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389449/Taskflow%20backgrounds/jukyghlsvncbyovcqvce.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389422/Taskflow%20backgrounds/2.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389420/Taskflow%20backgrounds/itjhqv6u26jigvxmzwsi.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389420/Taskflow%20backgrounds/sltgv2lrkmcbivdxxmb3.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389410/Taskflow%20backgrounds/yeozivyoaywjmj4hciwp.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389409/Taskflow%20backgrounds/idhd2wg760g7xa8vsze2.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389400/Taskflow%20backgrounds/t9jpmstlb7oaijmbynmw.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389394/Taskflow%20backgrounds/ponbl1heu65x22wus4ui.jpg","https://res.cloudinary.com/dhz1jk4k6/image/upload/v1601389391/Taskflow%20backgrounds/nnobztxqgr82swa61ne4.jpg"].map((function(e,t){return s.a.createElement("span",{style:{backgroundImage:"url(".concat(e,")")},className:"bg-item",key:t,onClick:function(){return f(e,"img")}})}))),"colors"===l&&s.a.createElement("div",{className:"bg-section-wrapper"},["#61bd4f","#f2d600","#ff9f1a","#c377e0","#eb5a46","#055a8c","#705cc1","#00c2e0","#ff78cb"].map((function(e,t){return s.a.createElement("span",{className:"bg-item",style:{backgroundColor:e},key:t,onClick:function(){return f(e,"color")}})}))))},Ne=function(e){var t=e.isMenuOpen,a=e.closeMenu,n=e.menuBtnRef,c=e.board,r=e.onBoardUpdated,l=Object(m.f)(),u=Object(i.useRef)(null),d=Object(i.useState)(null),b=Object(o.a)(d,2),f=b[0],p=b[1];k(u,(function(){t&&a()}),n),Object(i.useEffect)((function(){t&&p(null)}),[t]),Object(i.useEffect)((function(){return l.listen((function(e){u.current.classList.contains("menu-open")&&a()}))}),[l]);var v=function(e){switch(e){case"backgroundPicker":p(Object(g.a)(Object(g.a)({},f),{},{type:e,title:"Background"}))}};return s.a.createElement("div",{className:"board-menu ".concat(t?"menu-open":"  "),ref:u},s.a.createElement("div",{className:"pop-up-header"},s.a.createElement("h3",null,f?f.title:"Menu"),s.a.createElement("button",{className:"pop-up-close-btn clear-btn icon-lg",onClick:a},s.a.createElement(h.d,null))),f?s.a.createElement("div",{className:"board-menu-content"},"backgroundPicker"===f.type&&s.a.createElement(je,{onGoBack:function(){p(null)},board:c,onBoardUpdated:r})):s.a.createElement("div",{className:"board-menu-content"},s.a.createElement("div",{className:"board-menu-nav"},s.a.createElement("button",{className:"clear-btn board-menu-nav-btn",onClick:function(){return v("backgroundPicker")}},"Change background"),s.a.createElement("button",{className:"clear-btn board-menu-nav-btn",onClick:function(){return v("boardName")}},"Change board name"),s.a.createElement("button",{className:"clear-btn board-menu-nav-btn"},"Delete board")),s.a.createElement("div",null,s.a.createElement("div",{className:"section-title"},s.a.createElement(ve.a,{className:"icon-sm"}),s.a.createElement("h4",{className:""},"Activity")),s.a.createElement(me,null))))};t.default=function(){var e=Object(m.g)().boardId,t=Object(m.h)().path,a=Object(m.f)(),c=Object(m.h)().url,E=Object(u.c)(),g=Object(u.d)((function(e){return e.board.currBoard})),k=Object(i.useRef)(!0),h=Object(i.useRef)(null),j=Object(i.useState)(!1),N=Object(o.a)(j,2),y=N[0],C=N[1];Object(i.useEffect)((function(){(function(){var t=Object(l.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E(Object(d.a)(e));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),a.push("/boards");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(i.useEffect)((function(){k.current&&g&&(E(function(e){return function(){var t=Object(l.a)(r.a.mark((function t(a){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.getActivities(e);case 3:n=t.sent,a({type:"SET_ACTIVITIES",activities:n}),a({type:"SET_BOARD_ID",boardId:e}),t.next=12;break;case 8:throw t.prev=8,t.t0=t.catch(0),console.warn("cannot load activities",t.t0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e)),v.a.setup(),v.a.emit("board topic",g._id),v.a.on("update board",I),k.current=!1)}),[g]),Object(i.useEffect)((function(){return function(){console.log("render1"),v.a.off("update board",I),v.a.terminate()}}),[]);var x=function(){var e=Object(l.a)(r.a.mark((function e(t){var a,n,c,l=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:null,n=JSON.parse(JSON.stringify(g)),c=n.cardLists.findIndex((function(e){return e.id===t.id})),n.cardLists.splice(c,1,t),e.next=6,w(n);case 6:a&&E(z(a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=Object(i.useCallback)((function(e){E(Object(d.d)(e))}),[E]),I=function(e){E(Object(d.e)(e))},S=function(e){var t=JSON.parse(JSON.stringify(g)),a=t.cardLists.findIndex((function(t){return t.id===e}));t.cardLists.splice(a,1),w(t)},D=function(){C((function(e){return!e}))};return g?s.a.createElement("section",{className:"board-details",style:"color"===g.style.type?{backgroundColor:"".concat(g.style.background)}:{backgroundImage:"url(".concat(g.style.background,")")}},s.a.createElement("div",{className:"board-header"},s.a.createElement("button",null,"CLICK HERE"),s.a.createElement("button",{className:"clear-btn open-menu-btn",onClick:D,ref:h},s.a.createElement("span",{className:"icon-sm"},s.a.createElement(f.a,null)),s.a.createElement("span",null,"Menu"))),s.a.createElement(Ne,{isMenuOpen:y,closeMenu:D,menuBtnRef:h,board:g,onBoardUpdated:w}),g&&s.a.createElement(b.a,{onDragEnd:function(e){var t=e.source,a=e.destination;if(a&&(t.index!==a.index||t.droppableId!==a.droppableId)){var r=Object(n.a)(g.cardLists),l=JSON.parse(JSON.stringify(g));if(t.droppableId===a.droppableId&&"board"===t.droppableId){var o=p.a.reorder(r,t.index,a.index);l.cardLists=o}else{var i=+t.droppableId,s=+a.droppableId;if(i===s){var u=p.a.reorder(r[i].cards,t.index,a.index);l.cardLists[i].cards=u}else{var d=p.a.move(r[i].cards,r[s].cards,t,a);l.cardLists[i].cards=d[i],l.cardLists[s].cards=d[s];var m={fromList:r[i].title,toList:r[s].title,card:r[i].cards[t.index]},b=m.fromList,f=m.toList,v=m.card,k=O.a.newActivity("Moved this card from ".concat(b," to ").concat(f),"Moved [".concat(v.title,"](").concat(c,"/").concat(v.id,") from ").concat(b," to ").concat(f),v.id);E(z(k))}}w(l)}}},s.a.createElement(b.c,{droppableId:"board",type:"lists",direction:"horizontal"},(function(e,t){return s.a.createElement("div",Object.assign({className:"list-container",ref:e.innerRef},e.droppableProps),g.cardLists&&g.cardLists.map((function(e,t){return s.a.createElement(b.b,{key:e.id,draggableId:e.id,index:t,type:"lists"},(function(a,n){return s.a.createElement(U,{cardListIdx:t,cardList:e,onRemoveList:S,onListUpdated:x,innerRef:a.innerRef,provided:a})}))})),e.placeholder,s.a.createElement(pe,{board:g,onBoardUpdated:w}))}))),g&&s.a.createElement(m.a,{exact:!0,path:"".concat(t,"/:cardId"),component:fe})):s.a.createElement("div",{style:{paddingTop:"50px"}},"baba")}},45:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(41),c=a.n(n),r=a(42),l=a(68),o=a.n(l).a.create({withCredentials:!0}),i=function(e,t){return u(e,"GET",t)},s=function(e,t){return u(e,"PUT",t)};function u(e){return d.apply(this,arguments)}function d(){return(d=Object(r.a)(c.a.mark((function e(t){var a,n,r,l=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:"get",n=l.length>2&&void 0!==l[2]?l[2]:null,e.prev=2,e.next=5,o({url:"".concat("/api/").concat(t),method:a,data:n});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:if(e.prev=9,e.t0=e.catch(2),401!==e.t0.response.status){e.next=14;break}throw console.log("ERROR: cannot find boards"),e.t0;case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var m=a(51),b={query:function(){return i("board")},getById:function(e){return f.apply(this,arguments)},update:function(e){return p.apply(this,arguments)},getEmptyList:function(){return{id:m.a.makeId(),title:"",theme:"white",cards:[]}},getEmptyCard:function(){return{id:m.a.makeId(),title:"",description:"",creatorId:"",membersId:[],comments:[],dueDate:"",labels:[],isDone:!1,images:[],checklists:[],cover:{background:"",isFull:null,type:null}}},getEmptyCheckList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Checklist";return{id:m.a.makeId(),title:e,listItems:[]}},getEmptyListItem:function(){return{id:m.a.makeId(),title:"",isDone:!1}},newActivity:function(e,t,a){return{id:m.a.makeId(),cardTxt:e,boardTxt:t,cardId:a,date:Date.now()}},getActivities:function(e){return i("activity/".concat(e))},addActivity:function(e,t){return s("activity/".concat(e),t)}};function f(){return(f=Object(r.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i("board/".concat(t));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s("board/".concat(t._id),t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},50:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return m})),a.d(t,"g",(function(){return b})),a.d(t,"f",(function(){return f}));var n=a(41),c=a.n(n),r=a(42),l=a(45),o=a(53);function i(){return function(){var e=Object(r.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.query();case 2:(a=e.sent)&&t({type:"SET_BOARDS",boards:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}function s(e){return function(){var t=Object(r.a)(c.a.mark((function t(a){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.getById(e);case 3:n=t.sent,a({type:"SET_BOARD",currBoard:n}),t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(0),console.warn("cannot save board",t.t0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}function u(e){return function(){var t=Object(r.a)(c.a.mark((function t(a,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n().board.currBoard,a({type:"SET_BOARD",currBoard:e}),t.prev=2,t.next=5,l.a.update(e);case 5:i=t.sent,console.log("after board saved",i),o.a.emit("update board",i),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),a({type:"SET_BOARD",currBoard:r}),console.log("Err: Board saving failed");case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,a){return t.apply(this,arguments)}}()}function d(e){return function(t){t({type:"SET_BOARD",currBoard:e})}}function m(e){return function(){var t=Object(r.a)(c.a.mark((function t(a,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a({type:"SET_CARD",id:e});case 2:return t.abrupt("return",n().board.currCard);case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}function b(e){return function(t){t({type:"UPDATE_CARD",currCard:e})}}function f(){return function(e){e({type:"TOGGLE_LABELS"})}}},51:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(40),c=a(17),r={makeId:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},applyDrag:function(e,t){var a=t.removedIndex,n=t.addedIndex,r=t.payload;if(null===a&&null===n)return console.log("apply drag null"),e;var l=Object(c.a)(e),o=r;null!==a&&(o=l.splice(a,1)[0]);null!==n&&l.splice(n,0,o);return l},reorder:function(e,t,a){var c=Array.from(e),r=c.splice(t,1),l=Object(n.a)(r,1)[0];return c.splice(a,0,l),c},move:function(e,t,a,c){var r=Array.from(e),l=Array.from(t),o=r.splice(a.index,1),i=Object(n.a)(o,1)[0];l.splice(c.index,0,i);var s={};return s[a.droppableId]=r,s[c.droppableId]=l,s}}},53:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n,c=a(77),r=a.n(c),l={setup:function(){n=r()("/")},terminate:function(){n=null},on:function(e,t){n.on(e,t)},off:function(e,t){n&&n.off(e,t)},emit:function(e,t){n&&n.emit(e,t)}}},87:function(e,t){}}]);
//# sourceMappingURL=5.aa4071c2.chunk.js.map